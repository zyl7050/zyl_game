System.register("chunks:///_virtual/AudioManager.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(o){var i,u,e,n,t,s,a,c,r,d,l;return{setters:[function(o){i=o.inheritsLoose,u=o.createForOfIteratorHelperLoose,e=o.createClass},function(o){n=o.cclegacy,t=o._decorator,s=o.director,a=o.AudioSource,c=o.Node,r=o.resources,d=o.AudioClip,l=o.Component}],execute:function(){var h,p;n._RF.push({},"8f57aVVskBMMKCmeX07suR/","AudioManager",void 0);var M=t.ccclass;t.property,o("AudioManager",M("AudioManager")(((p=function(o){function n(){for(var i,u=arguments.length,e=new Array(u),n=0;n<u;n++)e[n]=arguments[n];return(i=o.call.apply(o,[this].concat(e))||this).audioSource=null,i.soundPool=[],i.soundCache=new Map,i.musicVolume=1,i.soundVolume=1,i.isMusicMuted=!1,i.isSoundMuted=!1,i}i(n,o);var t=n.prototype;return t.onLoad=function(){n._instance&&n._instance!==this?this.destroy():(n._instance=this,s.addPersistRootNode(this.node),this.initializeAudio())},t.initializeAudio=function(){this.audioSource=this.getComponent(a),this.audioSource||(this.audioSource=this.addComponent(a)),this.audioSource.volume=this.musicVolume,this.createSoundPool(),console.log("AudioManager initialized")},t.createSoundPool=function(){for(var o=0;o<10;o++){var i=new c("SoundSource_"+o);i.parent=this.node;var u=i.addComponent(a);u.volume=this.soundVolume,this.soundPool.push(u)}},t.preloadSound=function(o,i){var u=this;this.soundCache.has(o)?i&&i():r.load("sounds/voice/"+o,d,(function(e,n){e?console.error("Failed to load sound: "+o,e):(u.soundCache.set(o,n),i&&i())}))},t.playMusic=function(o,i,u){var e=this;void 0===i&&(i=!0),void 0===u&&(u=1),this.isMusicMuted||r.load("sounds/music/"+o,d,(function(n,t){n?console.error("Failed to load music: "+o,n):(e.audioSource.stop(),e.audioSource.clip=t,e.audioSource.loop=i,e.audioSource.volume=u*e.musicVolume,e.audioSource.play())}))},t.playSound=function(o,i){var u=this;if(void 0===i&&(i=1),this.isSoundMuted)return!1;var e=this.soundCache.get(o);return e?this.playSoundClip(e,i):(this.preloadSound(o,(function(){var e=u.soundCache.get(o);e&&u.playSoundClip(e,i)})),!0)},t.playSoundClip=function(o,i){void 0===i&&(i=1);for(var e,n=u(this.soundPool);!(e=n()).done;){var t=e.value;if(!t.playing)return t.stop(),t.clip=o,t.volume=i*this.soundVolume,t.play(),!0}return console.warn("No available audio source in pool"),!1},t.stopMusic=function(){this.audioSource.stop()},t.pauseMusic=function(){this.audioSource.pause()},t.resumeMusic=function(){this.isMusicMuted||this.audioSource.play()},t.setMusicVolume=function(o){this.musicVolume=Math.max(0,Math.min(1,o)),this.audioSource.volume=this.musicVolume},t.setSoundVolume=function(o){var i=this;this.soundVolume=Math.max(0,Math.min(1,o)),this.soundPool.forEach((function(o){o.volume=i.soundVolume}))},t.toggleMusicMute=function(){return this.isMusicMuted=!this.isMusicMuted,this.isMusicMuted?this.audioSource.pause():this.audioSource.play(),this.isMusicMuted},t.toggleSoundMute=function(){return this.isSoundMuted=!this.isSoundMuted,this.isSoundMuted},t.stopAllSounds=function(){this.soundPool.forEach((function(o){o.stop()}))},t.clearCache=function(){this.soundCache.clear()},t.onDestroy=function(){console.log("AudioManager onDestroy called"),this.stopAllSounds(),this.stopMusic(),this.clearCache(),n._instance=null,o.prototype.onDestroy.call(this)},e(n,null,[{key:"instance",get:function(){if(!this._instance){var o=s.getScene();if(!o)return console.error("No active scene found for AudioManager"),null;var i=o.getComponentInChildren(n);if(i)return this._instance=i,this._instance;console.error("AudioManager not found in scene. Please add AudioManager to the scene.")}return this._instance}}]),n}(l))._instance=null,h=p))||h);n._RF.pop()}}}));

System.register("chunks:///_virtual/BackgroundScroller.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(r){var e,t,n,i,o,a,c,l,u;return{setters:[function(r){e=r.applyDecoratedDescriptor,t=r.inheritsLoose,n=r.initializerDefineProperty,i=r.assertThisInitialized},function(r){o=r.cclegacy,a=r._decorator,c=r.Sprite,l=r.Vec2,u=r.Component}],execute:function(){var p,s,d,f,g,b;o._RF.push({},"08be51rydBOUrxr0XdgNMFO","BackgroundScroller",void 0);var h=a.ccclass,S=a.property;r("BackgroundScroller",(p=h("BackgroundScroller"),s=S(c),p((g=e((f=function(r){function e(){for(var e,t=arguments.length,o=new Array(t),a=0;a<t;a++)o[a]=arguments[a];return e=r.call.apply(r,[this].concat(o))||this,n(e,"backgroundSprite",g,i(e)),n(e,"scrollSpeedMultiplier",b,i(e)),e.material=null,e.currentOffset=new l(0,0),e}t(e,r);var o=e.prototype;return o.onLoad=function(){this.backgroundSprite&&(this.material=this.backgroundSprite.getMaterial(0))},o.update=function(r){},e.updateAllBackgrounds=function(){find("canvas").getComponentsInChildren(e).forEach((function(r){return r.update(0)}))},e}(u)).prototype,"backgroundSprite",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=e(f.prototype,"scrollSpeedMultiplier",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),d=f))||d));o._RF.pop()}}}));

System.register("chunks:///_virtual/DebugComponent.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var i,e,r,s,o,n,a,c,h,u,l;return{setters:[function(t){i=t.applyDecoratedDescriptor,e=t.inheritsLoose,r=t.initializerDefineProperty,s=t.assertThisInitialized},function(t){o=t.cclegacy,n=t._decorator,a=t.Graphics,c=t.Label,h=t.Vec3,u=t.Color,l=t.Component}],execute:function(){var p,g,b,d,f,y,_;o._RF.push({},"48150JF1qlGhZEhxAtssYgX","DebugComponent",void 0);var m=n.ccclass,k=n.property;t("DebugComponent",(p=m("DebugComponent"),g=k({type:a}),b=k({type:c}),p((y=i((f=function(t){function i(){for(var i,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return i=t.call.apply(t,[this].concat(o))||this,r(i,"graphics",y,s(i)),r(i,"debugLabel",_,s(i)),i._targetPosition=new h,i._detectionRadius=0,i._attackRadius=0,i}e(i,t);var o=i.prototype;return o.onLoad=function(){this.graphics||(this.graphics=this.getComponent(a))},o.setDebugInfo=function(t,i,e){this._targetPosition.set(t),this._detectionRadius=i,this._attackRadius=e},o.updateDebugText=function(t){this.debugLabel&&(this.debugLabel.string=t)},o.update=function(){if(this.graphics){this.graphics.clear(),this.graphics.circle(0,0,this._detectionRadius),this.graphics.strokeColor=u.YELLOW,this.graphics.stroke(),this.graphics.circle(0,0,this._attackRadius),this.graphics.strokeColor=u.RED,this.graphics.stroke();var t=this.node.worldPosition,i=new h;h.subtract(i,this._targetPosition,t),i.length()>0&&(i.normalize().multiplyScalar(50),this.graphics.moveTo(0,0),this.graphics.lineTo(i.x,i.z),this.graphics.strokeColor=u.GREEN,this.graphics.stroke())}},i}(l)).prototype,"graphics",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=i(f.prototype,"debugLabel",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),d=f))||d));o._RF.pop()}}}));

System.register("chunks:///_virtual/EnemySpawner.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(n){var e,t,r,i,a;return{setters:[function(n){e=n.inheritsLoose,t=n.applyDecoratedDescriptor,r=n.initializerDefineProperty,i=n.assertThisInitialized},function(n){a=n.cclegacy}],execute:function(){var s,o,c,p,l,u,f;a._RF.push({},"b02cfdDLmZMyqwG1m6Txr4k","EnemySpawner",void 0);var w=cc._decorator,h=w.ccclass,b=w.property;n("default",(s=b(cc.Prefab),h((c=function(n){function t(){for(var e,t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return e=n.call.apply(n,[this].concat(a))||this,r(e,"monsterPrefab",p,i(e)),r(e,"spawnInterval",l,i(e)),r(e,"spawnX",u,i(e)),r(e,"spawnY",f,i(e)),e.canSpawn=!0,e}e(t,n);var a=t.prototype;return a.start=function(){this.schedule(this.spawnMonster,this.spawnInterval)},a.spawnMonster=function(){if(this.canSpawn){var n=cc.instantiate(this.monsterPrefab);n.setPosition(this.spawnX,this.spawnY),this.node.addChild(n),this.canSpawn=!1}},a.onMonsterDied=function(){var n=this;this.canSpawn=!0,this.scheduleOnce((function(){n.canSpawn=!0}),this.spawnInterval)},t}(cc.Component),p=t(c.prototype,"monsterPrefab",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),l=t(c.prototype,"spawnInterval",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 3}}),u=t(c.prototype,"spawnX",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 500}}),f=t(c.prototype,"spawnY",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),o=c))||o));a._RF.pop()}}}));

System.register("chunks:///_virtual/EquipManager.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,i,n,o,s;return{setters:[function(e){t=e.inheritsLoose,i=e.applyDecoratedDescriptor,n=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){s=e.cclegacy}],execute:function(){var r,a,l,p,u,c,m,h,q,S,f,d;s._RF.push({},"de08exMo3FPEaA5kC5AKcr2","EquipManager",void 0);var g=cc._decorator,E=g.ccclass,M=g.property,z=function(e){return e[e.WEAPON=0]="WEAPON",e[e.HELMET=1]="HELMET",e[e.ARMOR=2]="ARMOR",e[e.BOOTS=3]="BOOTS",e[e.GLOVES=4]="GLOVES",e[e.RING=5]="RING",e[e.NECKLACE=6]="NECKLACE",e[e.BELT=7]="BELT",e[e.SHIELD=8]="SHIELD",e[e.CLOAK=9]="CLOAK",e[e.AMULET=10]="AMULET",e[e.BRACERS=11]="BRACERS",e[e.EARRING=12]="EARRING",e}(z||{});e("default",(r=M(cc.Node),a=M(cc.Node),l=M(cc.Prefab),p=M(cc.Node),u=M([cc.SpriteFrame]),E((m=function(e){function i(){for(var t,i=arguments.length,s=new Array(i),r=0;r<i;r++)s[r]=arguments[r];return t=e.call.apply(e,[this].concat(s))||this,n(t,"equipmentContainer",h,o(t)),n(t,"slotsContainer",q,o(t)),n(t,"equipmentPrefab",S,o(t)),n(t,"playerNode",f,o(t)),n(t,"equipmentSprites",d,o(t)),t._equipmentSlots=[],t.equipmentItems=[],t.equipmentSlots=[],t._currentEquipments=new Map,t._isMovingAll=!1,t._slotsWithNewEquipment=new Set,t.equipmentSizeMap=new Map,t.equipBgSizeMap=new Map,t.equipmentIconPaths=["equip1/1","equip1/2","equip1/3","equip1/4","equip1/5","equip1/6","equip1/7","equip1/8","equip1/9","equip1/10","equip1/11","equip1/12","equip1/13"],t.cachedSpriteFrames=new Map,t.loadFailedPaths=[],t}t(i,e);var s=i.prototype;return s.onLoad=function(){this.equipmentItems=[],this.equipmentSlots=[],this._equipmentSlots=[],console.log("GameManager onLoad, equipmentItems åˆå§‹åŒ–:",this.equipmentItems),this.preloadSpriteFrames(),this.safeInitialize(),this.initializeSizeMap(),this.initEqiupBgSizeMap()},s.initEqiupBgSizeMap=function(){this.equipBgSizeMap.set(z.WEAPON,new cc.Size(110,200)),this.equipBgSizeMap.set(z.HELMET,new cc.Size(110,145)),this.equipBgSizeMap.set(z.ARMOR,new cc.Size(110,54)),this.equipBgSizeMap.set(z.BOOTS,new cc.Size(110,95)),this.equipBgSizeMap.set(z.GLOVES,new cc.Size(50,93)),this.equipBgSizeMap.set(z.RING,new cc.Size(50,93)),this.equipBgSizeMap.set(z.NECKLACE,new cc.Size(110,95)),this.equipBgSizeMap.set(z.BELT,new cc.Size(110,95)),this.equipBgSizeMap.set(z.SHIELD,new cc.Size(110,95)),this.equipBgSizeMap.set(z.CLOAK,new cc.Size(110,45)),this.equipBgSizeMap.set(z.AMULET,new cc.Size(53,45)),this.equipBgSizeMap.set(z.BRACERS,new cc.Size(53,45)),this.equipBgSizeMap.set(z.EARRING,new cc.Size(225,95))},s.initializeSizeMap=function(){this.equipmentSizeMap.set(z.WEAPON,new cc.Size(90,150)),this.equipmentSizeMap.set(z.HELMET,new cc.Size(90,90)),this.equipmentSizeMap.set(z.ARMOR,new cc.Size(45,45)),this.equipmentSizeMap.set(z.BOOTS,new cc.Size(60,60)),this.equipmentSizeMap.set(z.GLOVES,new cc.Size(30,30)),this.equipmentSizeMap.set(z.RING,new cc.Size(30,30)),this.equipmentSizeMap.set(z.NECKLACE,new cc.Size(45,45)),this.equipmentSizeMap.set(z.BELT,new cc.Size(45,45)),this.equipmentSizeMap.set(z.SHIELD,new cc.Size(45,45)),this.equipmentSizeMap.set(z.CLOAK,new cc.Size(30,30)),this.equipmentSizeMap.set(z.AMULET,new cc.Size(25,25)),this.equipmentSizeMap.set(z.BRACERS,new cc.Size(25,25)),this.equipmentSizeMap.set(z.EARRING,new cc.Size(60,60))},s.preloadSpriteFrames=function(){console.log("å¼€å§‹é¢„åŠ è½½ SpriteFrame...")},s.safeInitialize=function(){var e=this;this.scheduleOnce((function(){e.initializeSlots()}),0)},s.initializeSlots=function(){try{if(this._equipmentSlots=[],!this.slotsContainer)return void console.error("slotsContainer æœªè®¾ç½®ï¼");var e=this.slotsContainer.children;console.log("æ‰¾åˆ° "+e.length+" ä¸ªè£…å¤‡æ ¼å­");for(var t=0;t<e.length&&!(t>=13);t++){var i=e[t].getComponent("EquipmentSlot");if(i){var n=t;i.setSlotType(n),this._equipmentSlots[n]=i,console.log("åˆå§‹åŒ–æ ¼å­ "+t+": "+e[t].name+", ç±»å‹: "+n)}else console.warn("æ ¼å­ "+t+" ä¸Šæœªæ‰¾åˆ° EquipmentSlot ç»„ä»¶")}console.log("è£…å¤‡æ ¼å­åˆå§‹åŒ–å®Œæˆï¼Œå…± "+this._equipmentSlots.length+" ä¸ªæ ¼å­")}catch(e){console.error("åˆå§‹åŒ–è£…å¤‡æ ¼å­æ—¶å‡ºé”™:",e)}},s.spawnRandomEquipments=function(){var e=this;if(console.log("å¼€å§‹ç”Ÿæˆéšæœºè£…å¤‡..."),this.equipmentPrefab)if(this.equipmentContainer){var t;this.equipmentItems||(this.equipmentItems=[],console.log("é‡æ–°åˆå§‹åŒ– equipmentItems æ•°ç»„")),console.log("è®¡åˆ’ç”Ÿæˆ "+t+" ä¸ªè£…å¤‡");var i=cc.find("Canvas");if(i){var n=i.getComponent("GameManager");if(n&&"function"==typeof n.getCurrentLevel)t=4==n.getCurrentLevel()?10:2+Math.floor(3*Math.random())}for(var o=0,s=0;s<t;s++){this.createRandomEquipment(s)&&o++}console.log("æˆåŠŸç”Ÿæˆ "+o+" ä¸ªè£…å¤‡ï¼ŒequipmentItems é•¿åº¦: "+this.equipmentItems.length),this.scheduleOnce((function(){e.moveAllEquipmentsToSlots()}),2)}else console.error("equipmentContainer æœªè®¾ç½®ï¼");else console.error("equipmentPrefab æœªè®¾ç½®ï¼")},s.createRandomEquipment=function(e){try{if(console.log("åˆ›å»ºç¬¬ "+e+" ä¸ªè£…å¤‡"),!this.equipmentPrefab)return console.error("equipmentPrefab æœªè®¾ç½®ï¼"),null;var t=cc.instantiate(this.equipmentPrefab);if(!this.equipmentContainer)return console.error("equipmentContainer æœªè®¾ç½®ï¼"),t.destroy(),null;this.equipmentContainer.addChild(t);var i=10+80*e;t.setPosition(i,0);var n=Math.floor(13*Math.random()),o={id:Date.now()+e,type:n,name:this.getEquipmentNameByType(n),icon:"equip_"+n,attack:Math.floor(3e3*Math.random())+1,defense:Math.floor(3e3*Math.random())+1};if(this.playerNode&&this.playerNode.isValid){var s=this.playerNode.getComponent("PlayerController");s&&s.setEquipData&&s.setEquipData(o)}var r=t.getComponent("EquipmentItem");return r&&r.init?(r.init(o),this.setEquipmentIcon(t,o),this.equipmentItems.push(r),console.log("è£…å¤‡ "+o.name+" å·²æ·»åŠ åˆ° equipmentItems, å½“å‰é•¿åº¦: "+this.equipmentItems.length),r):(console.error("è£…å¤‡é¢„åˆ¶ä½“æ²¡æœ‰ EquipmentItem ç»„ä»¶æˆ– init æ–¹æ³•"),t.destroy(),null)}catch(e){return console.error("åˆ›å»ºè£…å¤‡æ—¶å‡ºé”™:",e),null}},s.setEquipmentIcon=function(e,t){try{var i=this.equipmentSprites[t.type];if(i){var n=(e.getChildByName("spriteFrame")||e).getComponent(cc.Sprite);n?(n.spriteFrame=i,console.log("è®¾ç½®è£…å¤‡ "+t.name+" çš„å›¾æ ‡æˆåŠŸ")):console.warn("è£…å¤‡èŠ‚ç‚¹æ²¡æœ‰ Sprite ç»„ä»¶: "+t.name)}else console.warn("æ²¡æœ‰æ‰¾åˆ°ç±»å‹ "+t.type+" çš„è£…å¤‡å›¾æ ‡")}catch(e){console.error("è®¾ç½®è£…å¤‡å›¾æ ‡æ—¶å‡ºé”™:",e)}},s.getEquipmentNameByType=function(e){return["é’é“œå‰‘","é“å¤´ç›”","é”å­ç”²","çš®é´","çš®æ‰‹å¥—","é“¶æˆ’æŒ‡","é‡‘é¡¹é“¾","çš®è…°å¸¦","æœ¨ç›¾","æ–—ç¯·","æŠ¤èº«ç¬¦","é“æŠ¤è…•","é“¶è€³ç¯"][e]||"è£…å¤‡"+e},s.moveAllEquipmentsToSlots=function(){var e=this;if(this._isMovingAll&&console.log("æ­£åœ¨ç§»åŠ¨æ‰€æœ‰è£…å¤‡ï¼Œè¯·ç¨å€™..."),this._isMovingAll=!0,this._slotsWithNewEquipment.clear(),console.log("å¼€å§‹ç§»åŠ¨æ‰€æœ‰è£…å¤‡åˆ°å¯¹åº”æ ¼å­"),!this.equipmentItems)return console.warn("equipmentItems ä¸º null"),void(this._isMovingAll=!1);if(0===this.equipmentItems.length)return console.warn("equipmentItems ä¸ºç©ºæ•°ç»„ï¼Œæ²¡æœ‰è£…å¤‡å¯ç§»åŠ¨"),void(this._isMovingAll=!1);console.log("å…±æœ‰ "+this.equipmentItems.length+" ä¸ªè£…å¤‡éœ€è¦ç§»åŠ¨");for(var t=0,i=this.equipmentItems.length,n=function(n){var o=e.equipmentItems[n];if(!o)return console.warn("ç¬¬ "+n+" ä¸ªè£…å¤‡é¡¹ä¸º nullï¼Œè·³è¿‡"),t++,1;e.scheduleOnce((function(){e.processSingleEquipmentMove(o,n,t,i,e.equipmentSizeMap,e.equipBgSizeMap)}),.1*n)},o=0;o<this.equipmentItems.length;o++)n(o)},s.processSingleEquipmentMove=function(e,t,i,n,o,s){try{if(!e||!e.node||!e.node.isValid)return void console.warn("è£…å¤‡ "+t+" æ— æ•ˆï¼Œè·³è¿‡");if(e.hasMoved&&e.hasMoved())return void console.log("è£…å¤‡ "+t+" å·²ç»ç§»åŠ¨è¿‡ï¼Œè·³è¿‡");var r=e.getEquipmentInfo();if(!r)return void console.warn("è£…å¤‡ "+t+" æ²¡æœ‰è£…å¤‡ä¿¡æ¯ï¼Œè·³è¿‡");if(!this._equipmentSlots)return void console.warn("_equipmentSlots ä¸º null");var a=this._equipmentSlots[r.type];if(!a)return void console.warn("æœªæ‰¾åˆ°ç±»å‹ "+r.type+" çš„è£…å¤‡æ ¼å­");this._slotsWithNewEquipment.add(r.type),this.safeMoveEquipment(e,r,a,o,s,(function(){var e=i+1;console.log("è£…å¤‡ç§»åŠ¨å®Œæˆ: "+r.name+" ("+e+"/"+n+")")}))}catch(e){console.error("å¤„ç†è£…å¤‡ "+t+" ç§»åŠ¨æ—¶å‡ºé”™:",e)}},s.handleEquipmentEquip=function(e,t,i){var n=this._currentEquipments.get(e.type);n&&console.log("æ›¿æ¢æ—§è£…å¤‡: "+n.name),t.equip?t.equip(e,i):console.error("targetSlot æ²¡æœ‰ equip æ–¹æ³•"),this._currentEquipments.set(e.type,e),console.log("è£…å¤‡ "+e.name+" å·²ç©¿æˆ´åˆ°æ ¼å­ "+e.type)},s.restartGame=function(){console.log("é‡æ–°å¼€å§‹æ¸¸æˆ..."),this._equipmentSlots&&this._equipmentSlots.forEach((function(e){e&&e.clearSlot&&e.clearSlot()})),this._currentEquipments.clear(),this.equipmentContainer&&this.equipmentContainer.removeAllChildren(),this.equipmentItems=[],console.log("æ¸…ç©º equipmentItems æ•°ç»„"),this.spawnRandomEquipments(),this._isMovingAll=!1,console.log("æ¸¸æˆå·²é‡æ–°å¼€å§‹")},s.safeMoveEquipment=function(e,t,i,n,o,s){var r=this;if(!e)return console.error("å®‰å…¨ç§»åŠ¨: è£…å¤‡ä¸º null"),void s();if(!e.node||!e.node.isValid)return console.error("å®‰å…¨ç§»åŠ¨: è£…å¤‡èŠ‚ç‚¹æ— æ•ˆ"),void s();if(!i)return console.error("å®‰å…¨ç§»åŠ¨: ç›®æ ‡æ ¼å­ä¸º null"),void s();if(!i.node||!i.node.isValid)return console.error("å®‰å…¨ç§»åŠ¨: ç›®æ ‡æ ¼å­èŠ‚ç‚¹æ— æ•ˆ"),void s();console.log("å®‰å…¨ç§»åŠ¨: å¼€å§‹ç§»åŠ¨è£…å¤‡ "+(t?t.name:"æœªçŸ¥")+" åˆ°æ ¼å­ "+i.node.name);var a=e.node.parent;if(console.log("è£…å¤‡åŸå§‹çˆ¶èŠ‚ç‚¹: "+(a?a.name:"null")),console.log("é™çº§åˆ°ç›´æ¥ç§»åŠ¨æ–¹æ³•"),e.directMoveToSlot)try{e.directMoveToSlot(i.node,n,o,(function(){e.node&&e.node.isValid&&console.log("ç›´æ¥ç§»åŠ¨åè£…å¤‡çˆ¶èŠ‚ç‚¹: "+(e.node.parent?e.node.parent.name:"null")),r.handleEquipmentEquip(t,i,e.node),s()}))}catch(n){console.error("ç›´æ¥ç§»åŠ¨æ–¹æ³•å‡ºé”™:",n),this.fallbackMove(e,t,i,s)}else this.fallbackMove(e,t,i,s)},s.fallbackMove=function(e,t,i,n){try{console.log("ä½¿ç”¨æœ€ç»ˆå¤‡é€‰ç§»åŠ¨æ–¹æ³•"),e.node.parent=i.node,e.node.position=cc.Vec3.ZERO,e.node.scale=cc.Vec3.ONE,void 0!==e._hasMoved&&(e._hasMoved=!0),this.handleEquipmentEquip(t,i,e.node)}catch(e){console.error("æœ€ç»ˆå¤‡é€‰ç§»åŠ¨æ–¹æ³•ä¹Ÿå‡ºé”™:",e)}finally{n()}},i}(cc.Component),h=i(m.prototype,"equipmentContainer",[r],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=i(m.prototype,"slotsContainer",[a],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=i(m.prototype,"equipmentPrefab",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),f=i(m.prototype,"playerNode",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),d=i(m.prototype,"equipmentSprites",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),c=m))||c));s._RF.pop()}}}));

System.register("chunks:///_virtual/EquipmentData.ts",["cc"],(function(E){var t;return{setters:[function(E){t=E.cclegacy}],execute:function(){t._RF.push({},"1865c2hevtAR7r+oFgqmZ4d","EquipmentData",void 0);E("EquipmentType",function(E){return E[E.WEAPON=0]="WEAPON",E[E.HELMET=1]="HELMET",E[E.ARMOR=2]="ARMOR",E[E.BOOTS=3]="BOOTS",E[E.GLOVES=4]="GLOVES",E[E.RING=5]="RING",E[E.NECKLACE=6]="NECKLACE",E[E.BELT=7]="BELT",E[E.SHIELD=8]="SHIELD",E[E.CLOAK=9]="CLOAK",E[E.AMULET=10]="AMULET",E[E.BRACERS=11]="BRACERS",E[E.EARRING=12]="EARRING",E}({}));t._RF.pop()}}}));

System.register("chunks:///_virtual/EquipmentDetailPopup.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,i,n,o,r;return{setters:[function(e){t=e.inheritsLoose,i=e.applyDecoratedDescriptor,n=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){r=e.cclegacy}],execute:function(){var l,a,c,p,u,s,f,b,m,h,L,d,y,g,q,I,S,_;r._RF.push({},"3b7f1WZ+BpFHLGypZ59ayF8","EquipmentDetailPopup",void 0);var v=cc._decorator,w=v.ccclass,z=v.property;e("default",(l=z(cc.Label),a=z(cc.Label),c=z(cc.Label),p=z(cc.Label),u=z(cc.Label),s=z(cc.Label),f=z(cc.Sprite),b=z([cc.SpriteFrame]),w((h=function(e){function i(){for(var t,i=arguments.length,r=new Array(i),l=0;l<i;l++)r[l]=arguments[l];return t=e.call.apply(e,[this].concat(r))||this,n(t,"nameLabel",L,o(t)),n(t,"levelLabel",d,o(t)),n(t,"typeLabel",y,o(t)),n(t,"descriptionLabel",g,o(t)),n(t,"attackLabel",q,o(t)),n(t,"defLabel",I,o(t)),n(t,"iconSprite",S,o(t)),n(t,"equipmentSprites",_,o(t)),t._equipmentInfo=null,t}t(i,e);var r=i.prototype;return r.onLoad=function(){console.log("EquipmentDetailPopup onLoad")},r.init=function(e){this._equipmentInfo=e,this.updateUI()},r.updateUI=function(){if(this._equipmentInfo){if(this.nameLabel&&(this.nameLabel.string=this._equipmentInfo.name||"æœªçŸ¥è£…å¤‡"),this.levelLabel&&(this.levelLabel.string="ç­‰çº§: "+(this._equipmentInfo.level||"1")),this.typeLabel){var e=this._equipmentInfo.type||0;this.typeLabel.string="ç±»å‹: "+(["æ­¦å™¨","å¤´ç›”","ç›”ç”²","é´å­","æ‰‹å¥—","æˆ’æŒ‡","é¡¹é“¾","è…°å¸¦","ç›¾ç‰Œ","æŠ«é£","æŠ¤èº«ç¬¦","æŠ¤è…•","è€³ç¯"][e]||"æœªçŸ¥")}if(this.descriptionLabel&&(this.descriptionLabel.string=this._equipmentInfo.description||"æš‚æ— æè¿°"),this.attackLabel.string=this._equipmentInfo.attack,this.defLabel.string=this._equipmentInfo.defense,this.iconSprite&&cc.isValid(this.iconSprite.node)){this.iconSprite.node.active=!0;var t=this.equipmentSprites[this._equipmentInfo.type];if(t){var i=this.iconSprite.getComponent(cc.Sprite);if(i)i.spriteFrame=t,i.getComponent("cc.UITransform").setContentSize(cc.size(60,60)),console.log("è®¾ç½®è£…å¤‡ "+this._equipmentInfo.name+" çš„å›¾æ ‡æˆåŠŸ");else console.warn("è£…å¤‡èŠ‚ç‚¹æ²¡æœ‰ Sprite ç»„ä»¶: "+this._equipmentInfo.name)}else console.warn("æ²¡æœ‰æ‰¾åˆ°ç±»å‹ "+this._equipmentInfo.type+" çš„è£…å¤‡å›¾æ ‡");console.log("è£…å¤‡å›¾æ ‡é¢œè‰²å·²è®¾ç½®")}else console.warn("è£…å¤‡å›¾æ ‡ç»„ä»¶æœªæ‰¾åˆ°")}},r.loadEquipmentIcon=function(){var e=this,t=(this._equipmentInfo.type,"equipment/"+this._equipmentInfo.icon);cc.resources.load(t,cc.SpriteFrame,(function(t,i){t?console.error("åŠ è½½å¤‡ç”¨å›¾æ ‡ä¹Ÿå¤±è´¥:",t):e.iconSprite&&cc.isValid(e.iconSprite)&&(e.iconSprite.spriteFrame=i,console.log("å¤‡ç”¨å›¾æ ‡åŠ è½½æˆåŠŸ"))}))},r.onCloseClick=function(){this.node.destroy()},r.onDestroy=function(){console.log("EquipmentDetailPopup destroyed")},i}(cc.Component),L=i(h.prototype,"nameLabel",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),d=i(h.prototype,"levelLabel",[a],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=i(h.prototype,"typeLabel",[c],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g=i(h.prototype,"descriptionLabel",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=i(h.prototype,"attackLabel",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=i(h.prototype,"defLabel",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=i(h.prototype,"iconSprite",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=i(h.prototype,"equipmentSprites",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),m=h))||m));r._RF.pop()}}}));

System.register("chunks:///_virtual/EquipmentItem.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AudioManager.ts"],(function(e){var i,t,o,n,l,s;return{setters:[function(e){i=e.inheritsLoose,t=e.applyDecoratedDescriptor,o=e.initializerDefineProperty,n=e.assertThisInitialized},function(e){l=e.cclegacy},function(e){s=e.AudioManager}],execute:function(){var c,a,r,u,p,h,d,f,m,g,y,v,_,q,C,b,E,P;l._RF.push({},"40acfAT9n9ExoMccUPciJoz","EquipmentItem",void 0);var T=cc._decorator,S=T.ccclass,N=T.property;e("default",(c=N(cc.Sprite),a=N(cc.Label),r=N(cc.Node),u=N(cc.Node),p=N(cc.Node),h=N(cc.Node),d=N(cc.Sprite),f=N(cc.Prefab),S((g=function(e){function t(){for(var i,t=arguments.length,l=new Array(t),s=0;s<t;s++)l[s]=arguments[s];return i=e.call.apply(e,[this].concat(l))||this,o(i,"icon",y,n(i)),o(i,"nameLabel",v,n(i)),o(i,"background",_,n(i)),o(i,"qualityFrame",q,n(i)),o(i,"red_eff",C,n(i)),o(i,"gold_eff",b,n(i)),o(i,"equipmentSprite",E,n(i)),o(i,"equipmentDetailPrefab",P,n(i)),i._equipmentInfo=null,i._hasMoved=!1,i._originalParent=null,i._originalPosition=cc.Vec3.ZERO,i._originalScale=cc.Vec3.ZERO,i._isMoving=!1,i._detailPopup=null,i.equipShowNode=null,i}i(t,e);var l=t.prototype;return l.onLoad=function(){if(console.log("EquipmentItem onLoad, èŠ‚ç‚¹:",this.node.name),this._originalParent=this.node.parent,this._originalPosition=this.node.position.clone(),this._originalScale=this.node.scale.clone(),this.node.active=!0,this.node.opacity=255,this.qualityFrame&&cc.isValid(this.qualityFrame)&&(this.qualityFrame.active=!1,console.log("åˆå§‹åŒ–éšè—å“è´¨æ¡†")),this.gold_eff&&cc.isValid(this.gold_eff)){this.gold_eff.active=!0;var e=this.gold_eff.getComponent(cc.Animation);setTimeout((function(){e.play()}),0),console.log("åˆå§‹åŒ–æ˜¾ç¤ºå…‰æ•ˆ")}var i=this.getComponent(cc.Button)||this.node.addComponent(cc.Button);i&&(i.interactable=!0),this.addTouchListener(),console.log("EquipmentItem åˆå§‹åŒ–å®Œæˆ")},l.onDestroy=function(){this.node&&this.node.isValid&&this.node.off(cc.Node.EventType.TOUCH_END,this.onClick,this),this._isMoving=!1},l.addTouchListener=function(){this.node&&this.node.isValid&&this.node.off(cc.Node.EventType.TOUCH_END,this.onClick,this),this.node&&this.node.isValid?(this.node.on(cc.Node.EventType.TOUCH_END,this.onClick,this),this.node.active=!0,this.node.opacity=255):console.warn("æ— æ³•æ·»åŠ è§¦æ‘¸äº‹ä»¶ï¼šèŠ‚ç‚¹æ— æ•ˆ")},l.init=function(e){if(e){if(console.log("åˆå§‹åŒ–è£…å¤‡:",e),this._equipmentInfo=e,this._hasMoved=!1,this.node.scale=this._originalScale,this.node.opacity=255,this.node.active=!0,this.equipmentSprite&&cc.isValid(this.equipmentSprite.node)?(this.equipmentSprite.node.color=this.getColorByType(e.type),this.equipmentSprite.node.active=!0,console.log("è£…å¤‡å›¾æ ‡é¢œè‰²å·²è®¾ç½®")):console.warn("è£…å¤‡å›¾æ ‡ç»„ä»¶æœªæ‰¾åˆ°"),this.nameLabel&&cc.isValid(this.nameLabel.node)){var i=e.name||"æœªçŸ¥è£…å¤‡";this.nameLabel.string="Lv.20",this.nameLabel.node.active=!0,console.log("åç§°æ ‡ç­¾å·²è®¾ç½®:",i)}else console.warn("åç§°æ ‡ç­¾æœªæ‰¾åˆ°");this.qualityFrame&&cc.isValid(this.qualityFrame)&&(this.qualityFrame.active=!1),this.addTouchListener(),console.log("è£…å¤‡åˆå§‹åŒ–å®Œæˆï¼Œå“è´¨æ¡†å·²éšè—")}else console.error("EquipmentItem.init: equipmentInfo ä¸ºç©º")},l.getColorByType=function(e){var i=null!=e?e:0,t=[cc.Color.RED,cc.Color.BLUE,cc.Color.GREEN,cc.Color.YELLOW,cc.Color.ORANGE,cc.Color.MAGENTA,cc.Color.CYAN,cc.Color.GRAY,cc.Color.BROWN,cc.Color.BLACK,cc.Color.WHITE,cc.Color.ORANGE,cc.Color.MAGENTA];return t[Math.max(0,Math.min(i,t.length-1))]||cc.Color.WHITE},l.onClick=function(e){if(console.log("è£…å¤‡è¢«ç‚¹å‡», é€šçŸ¥ç§»åŠ¨æ‰€æœ‰è£…å¤‡"),this._hasMoved)console.log("å¼¹å‡ºè£…å¤‡è¯¦æƒ…çª—å£"),this.showEquipmentDetail();else{var i=cc.find("Canvas/equipLayer");if(i&&i.isValid){var t=i.getComponent("EquipManager");t&&"function"==typeof t.moveAllEquipmentsToSlots?t.moveAllEquipmentsToSlots():console.error("GameManager ç»„ä»¶æœªæ‰¾åˆ°æˆ– moveAllEquipmentsToSlots æ–¹æ³•ä¸å­˜åœ¨")}else console.error("GameManager èŠ‚ç‚¹æœªæ‰¾åˆ°æˆ–æ— æ•ˆ")}},l.showEquipmentDetail=function(){if(this.equipmentDetailPrefab){this._detailPopup&&cc.isValid(this._detailPopup)&&this._detailPopup.destroy(),this._detailPopup=cc.instantiate(this.equipmentDetailPrefab),this.equipShowNode=this.node.parent.parent.parent.getChildByName("equipShowLayer");var e=this.equipShowNode;if(e&&e.isValid){e.addChild(this._detailPopup),this._detailPopup.setPosition(cc.Vec3.ZERO);var i=this._detailPopup.getComponent("EquipmentDetailPopup");i&&"function"==typeof i.init&&i.init(this._equipmentInfo),this.setupPopupCloseListener(),console.log("è£…å¤‡è¯¦æƒ…å¼¹çª—å·²æ˜¾ç¤º")}else console.error("CanvasèŠ‚ç‚¹æœªæ‰¾åˆ°")}else console.error("è£…å¤‡è¯¦æƒ…å¼¹çª—é¢„åˆ¶ä½“æœªè®¾ç½®")},l.setupPopupCloseListener=function(){var e=this;if(this._detailPopup&&this._detailPopup.isValid){var i=this._detailPopup.getChildByName("closeButton");i&&i.isValid&&i.on(cc.Node.EventType.TOUCH_END,(function(){e.closeDetailPopup()}),this);var t=this._detailPopup.getChildByName("Layout");t&&t.isValid&&t.on(cc.Node.EventType.TOUCH_END,(function(){e.closeDetailPopup()}),this)}},l.closeDetailPopup=function(){this._detailPopup&&cc.isValid(this._detailPopup)&&(this._detailPopup.destroy(),this._detailPopup=null,console.log("è£…å¤‡è¯¦æƒ…å¼¹çª—å·²å…³é—­"))},l.directMoveToSlot=function(e,i,t,o){var n=this;if(!this.node||!this.node.isValid)return console.error("èŠ‚ç‚¹æ— æ•ˆ"),void(o&&o());if(this._hasMoved)return console.log("å·²ç»ç§»åŠ¨è¿‡"),void(o&&o());if(!e||!e.isValid)return console.error("ç›®æ ‡èŠ‚ç‚¹æ— æ•ˆ"),void(o&&o());console.log("ä½¿ç”¨ç›´æ¥ç§»åŠ¨æ–¹æ³•åˆ°:",e.name),this._hasMoved=!0,this.node.off(cc.Node.EventType.TOUCH_END,this.onClick,this),setTimeout((function(){n.addTouchListener()}),100);var l=this.getComponent(cc.Button);l&&(l.interactable=!1);var s=i.get(this._equipmentInfo.type),c=t.get(this._equipmentInfo.type);if(this.qualityFrame&&cc.isValid(this.qualityFrame)&&(this.qualityFrame.active=!0,s&&c)){var a=this.qualityFrame.getComponent("cc.UITransform"),r=this.equipmentSprite.getComponent("cc.UITransform");a&&r&&(a.setContentSize(c),r.setContentSize(s))}this.gold_eff&&cc.isValid(this.gold_eff)&&(this.gold_eff.active=!1),this.startMove(e),console.log("è£…å¤‡å·²ç›´æ¥æ”¾ç½®åˆ°è£…å¤‡æ ¼:",e.name),console.log("æœ€ç»ˆä½ç½®:",this.node.position.toString()),o&&o()},l.startMove=function(e){cc.Tween.stopAllByTarget(this.node);this.node.position.clone();cc.tween(this.node).to(.2,{scale:new cc.Vec3(1.3,1.3,1.3)}).to(.2,{scale:new cc.Vec3(1,1,1)}).call((function(){console.log("å¼€å§‹ç§»åŠ¨åˆ°ä¸­å¿ƒä½ç½®")})).to(.2,{position:cc.Vec3.ZERO}).call((function(){console.log("å¼€å§‹ç§»åŠ¨åˆ°æ§½ä½ä½ç½®"),s.instance.playSound("euqip_fly")})).to(.1,{position:e.position.clone()},{easing:"cubicOut"}).to(.4,{scale:new cc.Vec3(.9,.9,.9)},{easing:"sineIn"}).to(.4,{scale:new cc.Vec3(1,1,1)},{easing:"backOut"}).call((function(){})).start()},l.reset=function(){this._hasMoved=!1,this._isMoving=!1,this.node&&this.node.isValid&&(this.node.scale=this._originalScale,this.node.opacity=255),this.qualityFrame&&cc.isValid(this.qualityFrame)&&(this.qualityFrame.active=!1),this.addTouchListener(),this.closeDetailPopup()},l.getEquipmentInfo=function(){return this._equipmentInfo},l.hasMoved=function(){return this._hasMoved},l.getQualityFrame=function(){return this.qualityFrame},l.debugCoordinateSystem=function(e){this.node&&e&&(console.log("=== åæ ‡ç³»ç»Ÿè°ƒè¯• ==="),console.log(this.node),console.log("è£…å¤‡ä¸–ç•Œåæ ‡:",this.node.worldPosition.toString()),console.log("è£…å¤‡æœ¬åœ°åæ ‡:",this.node.position.toString()),console.log("è£…å¤‡æ ¼ä¸–ç•Œåæ ‡:",e.worldPosition.toString()),console.log("è£…å¤‡æ ¼æœ¬åœ°åæ ‡:",e.position.toString()),console.log("è£…å¤‡å½“å‰çˆ¶èŠ‚ç‚¹:",this.node.parent?this.node.parent.name:"null"),console.log("ç›®æ ‡çˆ¶èŠ‚ç‚¹:",e.name),console.log("=================="))},t}(cc.Component),y=t(g.prototype,"icon",[c],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=t(g.prototype,"nameLabel",[a],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=t(g.prototype,"background",[r],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=t(g.prototype,"qualityFrame",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=t(g.prototype,"red_eff",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=t(g.prototype,"gold_eff",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=t(g.prototype,"equipmentSprite",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=t(g.prototype,"equipmentDetailPrefab",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m=g))||m));l._RF.pop()}}}));

System.register("chunks:///_virtual/EquipmentSlot.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,i,n,o,c;return{setters:[function(e){t=e.inheritsLoose,i=e.applyDecoratedDescriptor,n=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){c=e.cclegacy}],execute:function(){var l,r,a,s,u,h,p,f,d,m,y,E;c._RF.push({},"e1d2fCvIyVEcKIVNOk2YFCZ","EquipmentSlot",void 0);var C=cc._decorator,_=C.ccclass,g=C.property;e("default",(l=g(cc.Sprite),r=g(cc.Label),a=g(cc.Node),s=g(cc.Label),u=g(cc.Node),_((p=function(e){function i(){for(var t,i=arguments.length,c=new Array(i),l=0;l<i;l++)c[l]=arguments[l];return t=e.call.apply(e,[this].concat(c))||this,n(t,"icon",f,o(t)),n(t,"nameLabel",d,o(t)),n(t,"emptyHint",m,o(t)),n(t,"typeLabel",y,o(t)),n(t,"equipmentContainer",E,o(t)),t._equipmentId=-1,t._slotType=0,t._currentEquipment=null,t._isPlayingEffect=!1,t._effectStartTime=0,t._effectDuration=0,t._originalScale=cc.Vec3.ONE,t._originalColor=new cc.Color(255,255,255),t}t(i,e);var c=i.prototype;return c.onLoad=function(){console.log("EquipmentSlot onLoad:",this.node.name),this._originalScale=this.node.scale.clone(),this._originalColor=this.node.color?this.node.color.clone():new cc.Color(255,255,255),this.safeClearSlot(),this.equipmentContainer||(this.equipmentContainer=this.node)},c.update=function(e){this.updateEffectAnimation()},c.updateEffectAnimation=function(){if(this._isPlayingEffect&&this.node&&this.node.isValid){var e=(Date.now()-this._effectStartTime)/1e3,t=Math.min(e/this._effectDuration,1);if(t<1){if(t<.25){var i=1-.2*(t/.25);this.node.scale=new cc.Vec3(i,i,1)}else if(t<.5){var n=.8+.3*((t-.25)/.25);this.node.scale=new cc.Vec3(n,n,1)}else{var o=1.1-.1*((t-.5)/.5);this.node.scale=new cc.Vec3(o,o,1)}if(t<.33){var c=t/.33,l=Math.floor(255-155*c),r=Math.floor(255-155*c);this.node.color=new cc.Color(l,255,r)}else{var a=(t-.33)/.67,s=Math.floor(100+155*a),u=Math.floor(100+155*a);this.node.color=new cc.Color(s,255,u)}}else this.node.scale=this._originalScale,this.node.color=this._originalColor,this._isPlayingEffect=!1}},c.safeClearSlot=function(){this._equipmentId=-1,this._currentEquipment&&cc.isValid(this._currentEquipment)&&(this._currentEquipment.destroy(),this._currentEquipment=null),this.icon&&cc.isValid(this.icon.node)&&(this.icon.node.active=!1),this.nameLabel&&cc.isValid(this.nameLabel.node)&&(this.nameLabel.string=""),this.emptyHint&&cc.isValid(this.emptyHint)&&(this.emptyHint.active=!0),this.updateTypeLabel()},c.setSlotType=function(e){var t=null!=e?e:0;this._slotType=t,this.updateTypeLabel()},c.updateTypeLabel=function(){if(this.typeLabel&&cc.isValid(this.typeLabel.node)){var e=["æ­¦å™¨","å¤´ç›”","ç›”ç”²","é´å­","æ‰‹å¥—","æˆ’æŒ‡","é¡¹é“¾","è…°å¸¦","ç›¾ç‰Œ","æŠ«é£","æŠ¤èº«ç¬¦","æŠ¤è…•","è€³ç¯"],t=Math.max(0,Math.min(this._slotType,e.length-1));this.typeLabel.string=e[t]||"ç±»å‹"+this._slotType}},c.getSlotType=function(){return this._slotType},c.equip=function(e,t){e?(this._equipmentId=e.id||-1,t&&cc.isValid(t)?this.handleEquipmentNode(t,e):this.showDefaultIcon(e),this.updateSlotDisplay(e),this.playEquipEffect(),console.log("è£…å¤‡ "+e.name+" å·²æˆåŠŸç©¿æˆ´åˆ°æ ¼å­")):console.error("equip æ–¹æ³•æ¥æ”¶åˆ°ç©ºçš„è£…å¤‡ä¿¡æ¯")},c.handleEquipmentNode=function(e,t){this._currentEquipment&&cc.isValid(this._currentEquipment)&&this._currentEquipment.destroy(),this._currentEquipment=e,this.equipmentContainer&&cc.isValid(this.equipmentContainer)?e.parent=this.equipmentContainer:e.parent=this.node,e.setPosition(cc.Vec3.ZERO),e.scale=cc.Vec3.ONE,e.opacity=255;var i=e.getComponent("EquipmentItem");if(i&&i.getQualityFrame){var n=i.getQualityFrame();n&&cc.isValid(n)&&(n.active=!0,n.scale=cc.Vec3.ONE)}console.log("è£…å¤‡èŠ‚ç‚¹å·²æˆåŠŸæ”¾ç½®åˆ°è£…å¤‡æ ¼å®¹å™¨")},c.showDefaultIcon=function(e){this.icon&&cc.isValid(this.icon.node)&&(this.icon.node.color=this.getColorByType(e.type),this.icon.node.active=!0)},c.updateSlotDisplay=function(e){this.nameLabel&&cc.isValid(this.nameLabel.node)&&(this.nameLabel.string=e.name||"æœªçŸ¥è£…å¤‡"),this.emptyHint&&cc.isValid(this.emptyHint)&&(this.emptyHint.active=!1)},c.getColorByType=function(e){var t=null!=e?e:0,i=[cc.Color.RED,cc.Color.BLUE,cc.Color.GREEN,cc.Color.YELLOW,cc.Color.ORANGE,cc.Color.MAGENTA,cc.Color.CYAN,cc.Color.GRAY,cc.Color.BROWN,cc.Color.BLACK,cc.Color.WHITE,cc.Color.ORANGE,cc.Color.MAGENTA];return i[Math.max(0,Math.min(t,i.length-1))]||cc.Color.WHITE},c.clearSlot=function(){this.safeClearSlot()},c.playEquipEffect=function(){cc.isValid(this.node)&&(this._isPlayingEffect&&(this.node.scale=this._originalScale,this.node.color=this._originalColor),this._isPlayingEffect=!0,this._effectStartTime=Date.now(),this._effectDuration=.4,console.log("å¼€å§‹æ’­æ”¾è£…å¤‡ç©¿æˆ´ç‰¹æ•ˆ"))},c.playSimpleEquipEffect=function(){var e=this;if(cc.isValid(this.node)){console.log("æ’­æ”¾ç®€åŒ–è£…å¤‡ç©¿æˆ´ç‰¹æ•ˆ");var t=this.node.color?this.node.color.clone():new cc.Color(255,255,255);this.node.color=new cc.Color(100,255,100),this.scheduleOnce((function(){e.node&&e.node.isValid&&(e.node.color=t)}),.3)}},c.getEquipmentId=function(){return this._equipmentId},c.isEmpty=function(){return-1===this._equipmentId},c.getCurrentEquipment=function(){return this._currentEquipment},c.getEquipmentContainer=function(){return this.equipmentContainer||this.node},c.onDestroy=function(){this._isPlayingEffect=!1},i}(cc.Component),f=i(p.prototype,"icon",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),d=i(p.prototype,"nameLabel",[r],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m=i(p.prototype,"emptyHint",[a],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=i(p.prototype,"typeLabel",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=i(p.prototype,"equipmentContainer",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),h=p))||h));c._RF.pop()}}}));

System.register("chunks:///_virtual/ExperienceManager.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var r,t,n,i,a,l;return{setters:[function(e){r=e.inheritsLoose,t=e.createClass,n=e.applyDecoratedDescriptor,i=e.initializerDefineProperty,a=e.assertThisInitialized},function(e){l=e.cclegacy}],execute:function(){var o,s,c,u,p,g,h,v,f,L,_;l._RF.push({},"e5362cBNolH3IpTnKi7Jjpc","ExperienceManager",void 0);var d=cc._decorator,x=d.ccclass,m=d.property;e("default",(o=m(cc.ProgressBar),s=m(cc.Label),c=m(cc.Label),u=m(cc.Node),x(((_=function(e){function n(){for(var r,t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(r=e.call.apply(e,[this].concat(n))||this)._currentExp=0,r._currentLevel=1,r._baseExpRequired=100,r._expMultiplier=1.5,i(r,"expProgressBar",h,a(r)),i(r,"levelLabel",v,a(r)),i(r,"expLabel",f,a(r)),i(r,"gameManagerNode",L,a(r)),r.gameManager=null,r}r(n,e);var l=n.prototype;return l.onLoad=function(){if(null===n._instance){if(n._instance=this,cc.game.addPersistRootNode(this.node),console.log("ExperienceManager åˆå§‹åŒ–å®Œæˆ"),this.gameManagerNode&&(this.gameManager=this.gameManagerNode.getComponent("GameManager")),!this.gameManager){var e=cc.director.getScene().getComponentsInChildren("GameManager");e.length>0&&(this.gameManager=e[0])}this.gameManager?console.log("æ‰¾åˆ° GameManager å¼•ç”¨"):console.warn("æœªæ‰¾åˆ° GameManager å¼•ç”¨"),this.updateUI()}else this.destroy()},l.onDestroy=function(){n._instance===this&&(n._instance=null)},l.getExpRequiredForLevel=function(e){return Math.floor(this._baseExpRequired*e*this._expMultiplier)},l.addExp=function(e){console.log("è·å¾— "+e+" ç‚¹ç»éªŒå€¼"),this._currentExp+=e;for(var r=this.getExpRequiredForLevel(this._currentLevel),t=0;this._currentExp>=r&&r>0;)this._currentExp-=r,this._currentLevel++,t++,console.log("å‡çº§åˆ° "+this._currentLevel+" çº§!"),this.gameManager&&this.gameManager.onPlayerLevelUp?this.gameManager.onPlayerLevelUp(this._currentLevel):console.warn("æ— æ³•è°ƒç”¨ GameManager çš„å‡çº§æ–¹æ³•"),r=this.getExpRequiredForLevel(this._currentLevel);t>0&&console.log("æœ¬æ¬¡å…±å‡çº§ "+t+" æ¬¡"),this.updateUI()},l.updateUI=function(){if(this.expProgressBar){var e=this.getExpRequiredForLevel(this._currentLevel),r=e>0?this._currentExp/e:1;this.expProgressBar.progress=r}if(this.levelLabel&&(this.levelLabel.string="Lv."+this._currentLevel),this.expLabel){var t=this.getExpRequiredForLevel(this._currentLevel);this.expLabel.string=this._currentExp+"/"+t}},l.showExpGain=function(e){console.log("è·å¾— "+e+" ç‚¹ç»éªŒå€¼")},l.getCurrentLevel=function(){return this._currentLevel},l.getCurrentExp=function(){return this._currentExp},l.reset=function(){this._currentExp=0,this._currentLevel=1,this.updateUI()},t(n,null,[{key:"instance",get:function(){return n._instance}}]),n}(cc.Component))._instance=null,h=n((g=_).prototype,"expProgressBar",[o],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=n(g.prototype,"levelLabel",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),f=n(g.prototype,"expLabel",[c],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=n(g.prototype,"gameManagerNode",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),p=g))||p));l._RF.pop()}}}));

System.register("chunks:///_virtual/GameManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ExperienceManager.ts","./HealthBar.ts","./AudioManager.ts","./SimpleFingerAnimation.ts"],(function(e){var t,n,r,o,i,a,s,l,c,u;return{setters:[function(e){t=e.inheritsLoose,n=e.createForOfIteratorHelperLoose,r=e.applyDecoratedDescriptor,o=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){a=e.cclegacy},function(e){s=e.default},function(e){l=e.HealthBar},function(e){c=e.AudioManager},function(e){u=e.SimpleFingerAnimation}],execute:function(){var h,d,p,f,v,g,m,y,C,L,w,b,M,N,P,k,A,S,D,B,x,E,I,F,z;a._RF.push({},"dc560cqUAhFRINbjgKiI3Ae","GameManager",void 0);var H=cc._decorator,V=H.ccclass,G=H.property;e("default",(h=G(cc.Node),d=G(cc.Prefab),p=G(cc.Prefab),f=G(cc.Node),v=G(cc.Node),g=G(cc.Node),m=G(cc.Label),y=G(cc.Label),V((L=function(e){function r(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,o(t,"startLayerNode",w,i(t)),o(t,"monsterPrefab",b,i(t)),o(t,"monsterBossPrefab",M,i(t)),o(t,"playerNode",N,i(t)),o(t,"playerNode1",P,i(t)),o(t,"monsterContainer",k,i(t)),o(t,"levelLabel",A,i(t)),o(t,"countdownLabel",S,i(t)),o(t,"spawnDelay",D,i(t)),o(t,"spawnX",B,i(t)),o(t,"spawnY",x,i(t)),o(t,"expPerMonster",E,i(t)),o(t,"healthIncreasePerKill",I,i(t)),o(t,"baseCountdown",F,i(t)),o(t,"countdownIncreasePerKill",z,i(t)),t.healthBar=null,t.monsters=[],t.isSpawning=!1,t.currentMonsterHealth=0,t.currentLevel=1,t.currentCountdown=0,t.isCountingDown=!1,t.killCount=0,t.currentMonster=null,t.monstersKilledThisLevel=0,t.totalMonstersThisLevel=0,t.fingerAnim=null,t.selectedCharacter=0,t.startLayer=null,t}t(r,e);var a=r.prototype;return a.onLoad=function(){this.playerNode?this.monsterPrefab?this.monsterContainer?(cc.director.addPersistRootNode(this.node),c.instance.preloadSound("voc_click"),c.instance.preloadSound("voc_lvup"),c.instance.preloadSound("voc_warn"),c.instance.playMusic("bgm0"),this.initEventListeners(),this.currentMonsterHealth=100,s.instance&&(s.instance.onLevelUp=this.onPlayerLevelUp.bind(this)),this.node.on("character-selected",this.getCurrentCharater,this),this.setupErrorHandling()):cc.error("MonsterContainer is not assigned in GameManager!"):cc.error("MonsterPrefab is not assigned in GameManager!"):cc.error("PlayerNode is not assigned in GameManager!")},a.showFinger=function(e,t){var n=cc.find("Canvas/shou");n&&(this.fingerAnim=n.getComponent(u),this.fingerAnim.showAtPosition(e,t))},a.hideFinger=function(){var e=cc.find("Canvas/shou");e&&(this.fingerAnim=e.getComponent(u),this.fingerAnim.hide())},a.initEventListeners=function(){this.startLayerNode&&(this.startLayerNode.on("character-selected",this.onCharacterSelected,this),this.startLayer=this.startLayerNode.getComponent("startLayer"))},a.onCharacterSelected=function(e){this.selectedCharacter=e,console.log("GameManager: ç©å®¶é€‰æ‹©äº†è§’è‰² "+e),this.handleCharacterSelection(e)},a.handleCharacterSelection=function(e){switch(e){case 1:console.log("æ‰§è¡Œè§’è‰²1çš„ç›¸å…³é€»è¾‘"),this.playerNode.active=!0,this.playerNode1.active=!1;break;case 2:console.log("æ‰§è¡Œè§’è‰²2çš„ç›¸å…³é€»è¾‘"),this.playerNode.active=!1,this.playerNode1.active=!0}},a.setupErrorHandling=function(){window.addEventListener("unhandledrejection",(function(e){console.error("æœªå¤„ç†çš„ Promise é”™è¯¯:",e.reason),e.preventDefault()})),window.addEventListener("error",(function(e){console.error("è¿è¡Œæ—¶é”™è¯¯:",e.error)}));var e=console.error;console.error=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];e.apply(console,n)}},a.update=function(e){this.isCountingDown&&0!=this.onCharacterSelected&&4!==this.currentLevel&&(this.currentCountdown-=e,this.updateCountdownDisplay(),this.currentCountdown<=0&&(this.currentCountdown=0,this.isCountingDown=!1,this.onCountdownFinished()),this.updateMonstersDepth())},a.updateMonstersDepth=function(){this.monsters.sort((function(e,t){return t.position.x-e.position.x}));for(var e=0;e<this.monsters.length;e++)this.monsters[e].setSiblingIndex(e)},a.startLevel=function(e){this.currentLevel=e,this.killCount=0,this.monstersKilledThisLevel=0,this.totalMonstersThisLevel=this.getMonstersCountByLevel(),this.currentCountdown=this.baseCountdown+(e-1)*this.countdownIncreasePerKill,this.isCountingDown=!0,this.updateLevelDisplay(),4==this.currentLevel?(console.log("bosså…³å¡ ä¸éœ€è¦è®¡æ—¶"),this.isCountingDown=!1):(this.updateCountdownDisplay(),console.log("ğŸ® å¼€å§‹ç¬¬ "+e+" å…³ï¼Œå€’è®¡æ—¶: "+this.currentCountdown.toFixed(1)+"ç§’")),this.spawnMonster()},a.nextLevel=function(){var e=this.currentLevel+1;this.startLevel(e)},a.updateLevelDisplay=function(){4==this.currentLevel&&(this.levelLabel.node.active=!1),this.levelLabel&&this.levelLabel.isValid&&(this.levelLabel.string="ç¬¬ "+this.currentLevel+" å…³")},a.updateCountdownDisplay=function(){this.countdownLabel&&this.countdownLabel.isValid&&(this.countdownLabel.string=this.currentCountdown.toFixed(1)+"ç§’",this.currentCountdown<=3?this.countdownLabel.node.color=cc.Color.RED:this.countdownLabel.node.color=cc.Color.WHITE)},a.onCountdownFinished=function(){console.log("â° ç¬¬ "+this.currentLevel+" å…³å€’è®¡æ—¶ç»“æŸï¼Œæœªèƒ½å‡»æ€æ€ªç‰©ï¼"),this.onLevelFailed()},a.onLevelFailed=function(){var e=this;console.log("âŒ ç¬¬ "+this.currentLevel+" å…³å¤±è´¥ï¼"),this.stopPlayerAttack(),this.destroyAllMonsters(),this.updateCountdownDisplay(),this.scheduleOnce((function(){e.startLevel(e.currentLevel)}),2)},a.stopPlayerAttack=function(){if(this.playerNode&&this.playerNode.isValid){var e=this.playerNode.getComponent("PlayerController");e&&e.stopAttack&&e.stopAttack()}if(this.playerNode1&&this.playerNode1.isValid){var t=this.playerNode1.getComponent("PlayerController");t&&t.stopAttack&&t.stopAttack()}},a.destroyAllMonsters=function(){for(var e,t=n(this.monsters);!(e=t()).done;){var r=e.value;r&&r.isValid&&r.destroy()}this.monsters=[]},a.spawnMonster=function(){var e=this;if(this.monsterPrefab){for(var t,n=this.getMonstersCountByLevel(),r=function(){var t;t=4===e.currentLevel?cc.instantiate(e.monsterBossPrefab):cc.instantiate(e.monsterPrefab);var r=80*(o-(n-1)/2);if(t.setPosition(e.spawnX+r,e.spawnY),!e.monsterContainer||!e.monsterContainer.isValid)return cc.error("Cannot add monster: monsterContainer is null or invalid!"),{v:void 0};e.monsterContainer.addChild(t);var i=t.getComponent("Monster");if(i?i.setGameManager?i.setGameManager(e):cc.warn("Monster script does not have setGameManager method!"):cc.warn("Monster script not found on monster prefab!"),i){var a=1+.2*(e.currentLevel-1),s=Math.floor(e.currentMonsterHealth*a);if(i.setMaxHealth){if(4==e.currentLevel){c.instance.playSound("skill_boss_enter");e.schedule((function e(){var t=this.playerNode.getComponent("PlayerController").isAlive();0!=this.monsters.length&&t?(i.bossSkillAnimation1(),this.scheduleOnce((function(){i.bossSkillAnimation3()}),.2),this.scheduleOnce((function(){i.bossSkillAnimation4()}),.3),this.scheduleOnce((function(){i.bossSkillAnimation5()}),.4)):this.unschedule(e)}),.8,10,3),s=5e5}else s=1e5;i.setMaxHealth(s)}else cc.warn("Monster script does not have setMaxHealth method!")}e.monsters.push(t)},o=0;o<n;o++)if(t=r())return t.v;this.isSpawning=!1,this.isCountingDown=!0}else cc.error("Cannot spawn monster: monsterPrefab is null!")},a.getMonstersCountByLevel=function(){switch(this.currentLevel){case 1:return 3;case 2:return 5;case 3:return 7;case 4:return 1;default:return 3+2*(this.currentLevel-1)}},a.onMonsterDied=function(e){this.isCountingDown=!1,this.killCount++,this.currentMonsterHealth+=this.healthIncreasePerKill;var t=this.monsters.indexOf(e);-1!==t&&this.monsters.splice(t,1),s.instance&&s.instance.addExp(this.expPerMonster),this.healthBar=this.getComponentInChildren(l),this.healthBar&&this.healthBar.setoffPosX();var n=this.playerNode.getComponent("PlayerController").isAlive();0!==this.monsters.length&&n||(this.isCountingDown=!1,this.onLevelCompleted())},a.onPlayerDied=function(e){this.isCountingDown=!1,this.onLevelCompleted()},a.onLevelCompleted=function(){console.log("âœ… ç¬¬ "+this.currentLevel+" å…³å®Œæˆï¼å‰©ä½™æ—¶é—´: "+this.currentCountdown.toFixed(1)+"ç§’"),this.countdownLabel&&this.countdownLabel.isValid&&(this.countdownLabel.string=" "+this.currentCountdown.toFixed(1)+"ç§’",this.countdownLabel.node.color=cc.Color.GREEN),this.stopPlayerAttack(),this.playerNode.getComponent("PlayerController").isAlive()&&this.spawnEquipmentAtLevelEnd(),this.checkAndShowSpecialInterface()},a.spawnEquipmentAtLevelEnd=function(){var e=this.node.getChildByName("equipLayer");if(e){var t=e.getComponent("EquipManager");if(t&&t.spawnRandomEquipments){var n=this.calculateDropCount();t.spawnRandomEquipments(this.currentLevel,n),console.log("ğŸ ç¬¬ "+this.currentLevel+" å…³ç»“æŸï¼Œæ‰è½ "+n+" ä»¶è£…å¤‡")}}},a.checkAndShowSpecialInterface=function(){var e={1:"slotMachine",3:"slotMachine",4:"overToOtherGame"}[this.currentLevel];if(e)switch(console.log("ğŸ° ç¬¬ "+this.currentLevel+" å…³è§¦å‘ç‰¹æ®Šç•Œé¢: "+e),e){case"slotMachine":this.showSlotMachineInterface();break;case"reward":this.showRewardInterface();break;case"overToOtherGame":this.gotoWeb();break;default:this.delayedNextLevel()}else this.delayedNextLevel()},a.calculateDropCount=function(){var e=1;e+=Math.floor(this.currentLevel/2);var t=this.monstersKilledThisLevel/this.totalMonstersThisLevel;return t>=1?e+=1:t>=.7&&(e+=0),Math.min(e,3)},a.showSlotMachineInterface=function(){var e=this;this.scheduleOnce((function(){var t=e.node.getChildByName("slotMachineLayer");if(t){t.active=!0;var n=cc.find("Canvas");if(n)n.getComponent("GameManager").showFinger(cc.Vec3(0,0,0),cc.Vec3(280,-9,0))}var r=t.getComponent("SlotMachine");r&&r.active,t.once("slot-machine-completed",e.onSlotMachineCompleted,e),console.log("ğŸ¯ è€è™æœºç•Œé¢å·²æ˜¾ç¤ºï¼Œç­‰å¾…æŠ½å¥–å®Œæˆ...")}),4)},a.onSlotMachineCompleted=function(e){console.log("ğŸ‰ è€è™æœºæŠ½å¥–å®Œæˆï¼Œè·å¾—å¥–åŠ±:",e),1===this.currentLevel?1==this.selectedCharacter?(this.node.getChildByName("characterLayer").emit("player-skill-upgraded","atk3f",.8),this.node.getChildByName("characterLayer").emit("player-skill-upgraded","atk3g",.8),this.node.getChildByName("characterLayer").emit("player-skill-upgraded","atk2",.8)):this.node.getChildByName("characterLayer1").emit("player-skill-upgraded","atk2",.8):3===this.currentLevel&&(1==this.selectedCharacter?this.node.getChildByName("characterLayer").emit("player-skill-upgraded","ult",2):this.node.getChildByName("characterLayer1").emit("player-skill-upgraded","ult",2),this.node.getChildByName("UILayer").getChildByName("bossEnter").active=!0,c.instance.playSound("voc_warn",1)),this.hideFinger(),this.delayedNextLevel()},a.gotoWeb=function(){var e=this;this.scheduleOnce((function(){e.node.getChildByName("webLayer").active=!0}),2.5)},a.delayedNextLevel=function(){var e=this;this.scheduleOnce((function(){e.node.getChildByName("UILayer").getChildByName("bossEnter").active=!1,e.nextLevel()}),1.5)},a.onPlayerLevelUp=function(e){if(console.log("ğŸ‰ GameManager: ç©å®¶å‡çº§åˆ° "+e+" çº§!"),this.playerNode&&this.playerNode.isValid){var t=this.playerNode.getComponent("PlayerController");t&&t.onLevelUp&&t.onLevelUp(e)}if(this.playerNode1&&this.playerNode1.isValid){var n=this.playerNode1.getComponent("PlayerController");n&&n.onLevelUp&&n.onLevelUp(e)}},a.getMonsters=function(){return this.monsters},a.getCurrentMonsterHealth=function(){return this.currentMonsterHealth},a.getCurrentLevel=function(){return this.currentLevel},a.getCurrentCountdown=function(){return this.currentCountdown},a.getKillCount=function(){return this.killCount},a.getCurrentMonster=function(){return this.currentMonster},a.getPlayerPosition=function(){return this.playerNode&&this.playerNode.isValid?this.playerNode.position:cc.Vec2.ZERO},a.getMonsterPosition=function(){return this.currentMonster&&this.currentMonster.isValid?this.currentMonster.position:new cc.Vec2(this.spawnX,this.spawnY)},r}(cc.Component),w=r(L.prototype,"startLayerNode",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=r(L.prototype,"monsterPrefab",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=r(L.prototype,"monsterBossPrefab",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=r(L.prototype,"playerNode",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=r(L.prototype,"playerNode1",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=r(L.prototype,"monsterContainer",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=r(L.prototype,"levelLabel",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=r(L.prototype,"countdownLabel",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=r(L.prototype,"spawnDelay",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 3}}),B=r(L.prototype,"spawnX",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 800}}),x=r(L.prototype,"spawnY",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),E=r(L.prototype,"expPerMonster",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 50}}),I=r(L.prototype,"healthIncreasePerKill",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 20}}),F=r(L.prototype,"baseCountdown",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),z=r(L.prototype,"countdownIncreasePerKill",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.1}}),C=L))||C));a._RF.pop()}}}));

System.register("chunks:///_virtual/GameMode.ts",["cc"],(function(e){var t,c;return{setters:[function(e){t=e.cclegacy,c=e._decorator}],execute:function(){var n;t._RF.push({},"ce9babIucBMwoD+SyQGUp6m","GameMode",void 0);var o=c.ccclass;c.property,e("GameMode",o("GameMode")(n=function(){function e(){}var t=e.prototype;return t.init=function(){},t.initCharacters=function(){},t.update=function(e){},e}())||n);t._RF.pop()}}}));

System.register("chunks:///_virtual/HealthBar.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,a,i,o,r,n,s,l,c,h,u,m,f,d,p,g,b,v;return{setters:[function(e){t=e.applyDecoratedDescriptor,a=e.inheritsLoose,i=e.initializerDefineProperty,o=e.assertThisInitialized,r=e.createForOfIteratorHelperLoose,n=e.createClass},function(e){s=e.cclegacy,l=e._decorator,c=e.ProgressBar,h=e.Label,u=e.Color,m=e.SpriteFrame,f=e.tween,d=e.Vec3,p=e.UIOpacity,g=e.Vec2,b=e.Sprite,v=e.Component}],execute:function(){var w,y,D,_,N,S,H,z,B,C,T,E,x,P,A,F,V,O,M,k,I,L,X,W,q,R,j,K,Q,U,G,J,Y,Z,$,ee,te,ae,ie,oe,re,ne;s._RF.push({},"c19249Px7BAPq2gztW9qOgL","HealthBar",void 0);var se=l.ccclass,le=l.property;e("HealthBar",(w=se("HealthBar"),y=le(c),D=le(h),_=le(c),N=le({type:u,tooltip:"æ™®é€šä¼¤å®³é¢œè‰²"}),S=le({type:u,tooltip:"æš´å‡»ä¼¤å®³é¢œè‰²"}),H=le({type:u,tooltip:"æ²»ç–—é¢œè‰²"}),z=le({type:u,tooltip:"AOEä¼¤å®³é¢œè‰²"}),B=le({type:Number,tooltip:"æš´å‡»å­—ä½“å¤§å°"}),C=le({type:Number,tooltip:"æ™®é€šå­—ä½“å¤§å°"}),T=le({type:Number,tooltip:"AOEå­—ä½“å¤§å°"}),E=le({type:m,tooltip:"æš´å‡»ç‰¹æ•ˆå›¾ç‰‡"}),x=le({type:Number,tooltip:"ä¼¤å®³æ•°å­—æ˜¾ç¤ºåŒºåŸŸå®½åº¦"}),P=le({type:Number,tooltip:"ä¼¤å®³æ•°å­—æ˜¾ç¤ºåŒºåŸŸé«˜åº¦"}),A=le({type:Number,tooltip:"ä¼¤å®³æ•°å­—æ˜¾ç¤ºæŒç»­æ—¶é—´(ç§’)"}),F=le({type:Number,tooltip:"ä¼¤å®³æ•°å­—å‚ç›´é—´è·"}),V=le({type:Number,tooltip:"ä¼¤å®³æ•°å­—æœ€å¤§æ˜¾ç¤ºæ•°é‡"}),O=le({type:Number,tooltip:"æ°´å¹³åˆ†æ•£èŒƒå›´"}),M=le({type:Number,tooltip:"å‚ç›´åˆ†æ•£èŒƒå›´"}),k=le({type:Number,tooltip:"åŸºç¡€å‚ç›´ä½ç½®"}),w((X=t((L=function(e){function t(){for(var t,a=arguments.length,r=new Array(a),n=0;n<a;n++)r[n]=arguments[n];return t=e.call.apply(e,[this].concat(r))||this,i(t,"healthBar",X,o(t)),i(t,"healthText",W,o(t)),i(t,"damageEffectBar",q,o(t)),i(t,"animationDuration",R,o(t)),i(t,"normalDamageColor",j,o(t)),i(t,"critDamageColor",K,o(t)),i(t,"healColor",Q,o(t)),i(t,"aoeDamageColor",U,o(t)),i(t,"critFontSize",G,o(t)),i(t,"normalFontSize",J,o(t)),i(t,"aoeFontSize",Y,o(t)),i(t,"critEffectSprite",Z,o(t)),i(t,"damageAreaWidth",$,o(t)),i(t,"damageAreaHeight",ee,o(t)),i(t,"damageDisplayDuration",te,o(t)),i(t,"damageVerticalSpacing",ae,o(t)),i(t,"maxDamageNumbers",ie,o(t)),i(t,"horizontalSpread",oe,o(t)),i(t,"verticalSpread",re,o(t)),i(t,"baseVerticalPosition",ne,o(t)),t._maxHealth=100,t._currentHealth=100,t._damageEffectHealth=100,t._targetNode=null,t._activeDamageNumbers=new Map,t._damageNumberId=0,t._lastDamagePositions=[],t._verticalOffset=0,t._activeTweens=[],t._damageNumberQueue=[],t.offPosX=0,t._isShowingAoeEffect=!1,t._aoeEffectTimer=null,t}a(t,e);var s=t.prototype;return s.onLoad=function(){this.healthBar&&(this.healthBar.progress=1),this.damageEffectBar&&(this.damageEffectBar.progress=1),this.updateHealthText()},s.onDestroy=function(){this.clearAllTweens(),this.clearAllDamageNumbers()},s.init=function(e,t){this._maxHealth=e,this._currentHealth=void 0!==t?t:e,this._damageEffectHealth=this._currentHealth,this.offPosX=0,this.updateHealthBarImmediately(),this.updateHealthText()},s.setHealth=function(e){this._currentHealth=Math.max(0,Math.min(e,this._maxHealth)),this.updateHealthBar(),this.updateHealthText()},s.takeDamage=function(e,t,a){void 0===t&&(t=!1),void 0===a&&(a=!1);var i=Math.max(0,this._currentHealth-e);this.setHealth(i),this.showDamageEffect(e,t,a),a&&this.showAoeDamageEffect()},s.heal=function(e){var t=Math.min(this._maxHealth,this._currentHealth+e);this.setHealth(t),this.showHealEffect(e)},s.updateHealthBar=function(){var e=this,t=this._currentHealth/this._maxHealth;this.healthBar&&f(this.healthBar).to(this.animationDuration,{progress:t}).start(),this.damageEffectBar&&this.scheduleOnce((function(){f(e.damageEffectBar).to(1.5*e.animationDuration,{progress:t}).start()}),this.animationDuration/2)},s.updateHealthBarImmediately=function(){var e=this._currentHealth/this._maxHealth;this.healthBar&&(this.healthBar.progress=e),this.damageEffectBar&&(this.damageEffectBar.progress=e)},s.updateHealthText=function(){if(this.healthText){this.healthText.string=Math.ceil(this._currentHealth)+"/"+this._maxHealth;var e=this._currentHealth/this._maxHealth;this.healthText.color=e<=.3?new u(255,50,50):new u(255,255,e<=.6?0:255)}},s.showDamageEffect=function(e,t,a){var i,o,r;void 0===t&&(t=!1),void 0===a&&(a=!1),t?(i="-"+e,o=this.critDamageColor,r=this.critFontSize,this.playCritEffect()):a?(i="èŒƒå›´ -"+e,o=this.aoeDamageColor,r=this.aoeFontSize):(i="-"+e,o=this.normalDamageColor,r=this.normalFontSize),this.createStackingFloatingText(i,o,r,t)},s.playCritEffect=function(){if(this.healthBar&&this.healthBar.node&&this.isValidTarget(this.healthBar)){var e=f(this.healthBar.node).to(.05,{scale:new d(1.2,1.2,1)}).to(.05,{scale:new d(.9,.9,1)}).to(.05,{scale:new d(1.1,1.1,1)}).to(.05,{scale:new d(1,1,1)}).start();this._activeTweens.push(e)}},s.showAoeDamageEffect=function(){var e=this;if(!this._isShowingAoeEffect){if(this._isShowingAoeEffect=!0,this.node){var t=this.node.scale.clone();f(this.node).to(.1,{scale:new d(1.05,1.05,1)}).to(.1,{scale:t}).call((function(){e._isShowingAoeEffect=!1})).start()}this._aoeEffectTimer&&clearTimeout(this._aoeEffectTimer),this._aoeEffectTimer=setTimeout((function(){e._isShowingAoeEffect=!1}),1e3)}},s.showHealEffect=function(e){if(this.createFloatingText("+"+e,this.healColor,this.normalFontSize),this.healthBar&&this.healthBar.node){var t,a=(null==(t=this.healthBar.node.color)?void 0:t.clone())||new u(255,255,255);f(this.healthBar.node).to(.2,{color:new u(100,255,100)}).to(.2,{color:a}).start()}},s.createFloatingText=function(e,t,a,i){void 0===a&&(a=40),void 0===i&&(i=!1);var o=this._damageNumberId++,r=new cc.Node("FloatingText"),n=r.addComponent(h),s=r.addComponent(p);n.string=e,n.color=t,n.fontSize=a,n.isBold=i,n.lineHeight=a,i&&(n.shadowColor=new u(100,0,0,150),n.shadowOffset=new g(2,-2),n.shadowBlur=2);var l=this.calculateNonOverlapPosition();r.setPosition(l),this.node.addChild(r),i&&this.critEffectSprite&&this.createCritEffect(r),this.playDamageNumberAnimation(r,s,o,i)},s.calculateNonOverlapPosition=function(){var e,t=0;do{var a=(Math.random()-.5)*this.damageAreaWidth,i=50+Math.random()*this.damageAreaHeight*.5;e=new d(a,i,0),t++}while(this.isPositionOverlapping(e)&&t<10);return this._lastDamagePositions.push(e.clone()),this._lastDamagePositions.length>5&&this._lastDamagePositions.shift(),e},s.isPositionOverlapping=function(e){for(var t,a=r(this._lastDamagePositions);!(t=a()).done;){var i=t.value;if(d.distance(e,i)<40)return!0}return!1},s.createCritEffect=function(e){var t=new cc.Node("CritEffect"),a=t.addComponent(b),i=t.addComponent(p);a.spriteFrame=this.critEffectSprite,t.setScale(0,0,0),i.opacity=200,t.x=t.x-100,e.addChild(t);var o=f(t).to(.1,{scale:new d(1.5,1.5,1)}).to(.2,{scale:new d(1,1,1)}).delay(.2).to(.2,{scale:new d(.5,.5,1)}).call((function(){t&&t.isValid&&f(i).to(.2,{opacity:0}).call((function(){t&&t.isValid&&t.destroy()})).start()})).start();this._activeTweens.push(o)},s.playDamageNumberAnimation=function(e,t,a,i){var o=this;if(this.isValidTarget(e)){var r=e.scale.clone();this._activeDamageNumbers.set(a,{node:e,position:e.position.clone()});var n,s=f(e).parallel(f().by(1.2,{position:new d(0,100,0)}),f(t).delay(.4).to(.8,{opacity:0}));n=i?f(e).to(.1,{scale:new d(1.8,1.8,1)}).to(.1,{scale:new d(1.2,1.2,1)}).to(.1,{scale:new d(1.5,1.5,1)}).to(.1,{scale:new d(1,1,1)}).then(s).call((function(){o._activeDamageNumbers.delete(a),e&&e.isValid&&e.destroy()})).start():f(e).to(.1,{scale:new d(1.3,1.3,1)}).to(.1,{scale:r}).then(s).call((function(){o._activeDamageNumbers.delete(a),e&&e.isValid&&e.destroy()})).start(),this._activeTweens.push(n);var l=30*(Math.random()-.5);f(e).by(1.2,{position:new d(l,0,0)}).start()}},s.setoffPosX=function(){this.offPosX=0},s.createStackingFloatingText=function(e,t,a,i){var o=this;void 0===i&&(i=!1);var r=this._damageNumberId++,n=new cc.Node("FloatingText"),s=n.addComponent(h),l=n.addComponent(p),c=n.addComponent(cc.LabelOutline);s.string=e,s.color=t,s.fontSize=a,s.isBold=i,s.lineHeight=a,i&&(s.shadowColor=new u(100,0,0,150),s.shadowOffset=new d(2,-2,0),s.shadowBlur=2,c.color=cc.Color.BLACK,c.width=2);var m=this.calculateStackingPosition();n.setPosition(m),this.node&&this.node.isValid?(this.node.addChild(n),i&&this.critEffectSprite&&this.createCritEffect(n),this.playStackingDamageAnimation(n,l,r,i),this._verticalOffset+=this.damageVerticalSpacing,this.scheduleOnce((function(){o._verticalOffset=Math.max(0,o._verticalOffset-o.damageVerticalSpacing)}),this.damageDisplayDuration)):n.destroy()},s.calculateStackingPosition=function(){this.offPosX-=5,this.offPosX<=100&&(this.offPosX=0);var e=50+this._verticalOffset;return e>320&&(this._verticalOffset=0),new d(this.offPosX,e,0)},s.playStackingDamageAnimation=function(e,t,a,i){var o=this,r=e.scale.clone();this._activeDamageNumbers.set(a,{node:e,position:e.position.clone()});var n,s=this.damageDisplayDuration,l=.6*s,c=s-l;n=i?f(e).to(.1,{scale:new d(1.8,1.8,1)}).to(.1,{scale:new d(1.2,1.2,1)}).to(.1,{scale:new d(1.5,1.5,1)}).to(.1,{scale:new d(1,1,1)}).parallel(f().by(.8*s,{position:new d(0,30,0)}),f(t).delay(l).to(c,{opacity:0})).call((function(){o._activeDamageNumbers.delete(a),e&&e.isValid&&e.destroy()})).start():f(e).to(.1,{scale:new d(1.3,1.3,1)}).to(.1,{scale:r}).call((function(){o._activeDamageNumbers.delete(a),f(t).to(.2,{opacity:0}).call((function(){e&&e.isValid&&e.destroy()})).start()})).start(),this.scheduleOnce((function(){o._activeDamageNumbers.has(a)&&o.removeDamageNumber(a)}),s+1),this._activeTweens.push(n)},s.removeDamageNumber=function(e){var t=this._activeDamageNumbers.get(e);t&&(t.node&&t.node.isValid&&t.node.destroy(),this._activeDamageNumbers.delete(e))},s.createScatteredFloatingText=function(e,t,a,i){if(void 0===i&&(i=!1),this._activeDamageNumbers.size>=this.maxDamageNumbers){var o=Array.from(this._activeDamageNumbers.keys())[0];this.removeDamageNumber(o)}var r=this._damageNumberId++,n=new cc.Node("FloatingText"),s=n.addComponent(h),l=n.addComponent(p);s.string=e,s.color=t,s.fontSize=a,s.isBold=i,s.lineHeight=a,i&&(s.shadowColor=new u(100,0,0,150),s.shadowOffset=new d(2,-2,0),s.shadowBlur=2);var c=this.calculateScatteredPosition();n.setPosition(c),this.node&&this.node.isValid?(this.node.addChild(n),i&&this.critEffectSprite&&this.createCritEffect(n),this._activeDamageNumbers.set(r,{node:n,opacity:l,startTime:Date.now(),displayDuration:this.damageDisplayDuration,isCrit:i}),this.playScatteredDamageAnimation(r)):n.destroy()},s.removeDamageNumber=function(e){var t=this._activeDamageNumbers.get(e);t&&(t.node&&t.node.isValid&&t.node.destroy(),this._activeDamageNumbers.delete(e))},s.calculateScatteredPosition=function(){var e=(Math.random()-.5)*this.horizontalSpread,t=this.baseVerticalPosition+Math.random()*this.verticalSpread;return new d(e,t,0)},s.playScatteredDamageAnimation=function(e){var t=this,a=this._activeDamageNumbers.get(e);if(a&&this.isValidTarget(a.node)){var i,o=a.node,r=a.opacity,n=a.displayDuration,s=a.isCrit,l=(o.position.clone(),60+40*Math.random()),c=80*(Math.random()-.5),h=15*(Math.random()-.5),u=.6*n,m=n-u;i=s?f(o).to(.1,{scale:new d(2,2,1)}).to(.1,{scale:new d(1.3,1.3,1)}).to(.1,{scale:new d(1.8,1.8,1)}).to(.1,{scale:new d(1.5,1.5,1)}).parallel(f().by(.8*n,{position:new d(c,l,0)}),f().by(.5*n,{angle:h}),f(r).delay(u).to(m,{opacity:0})).call((function(){t.removeDamageNumber(e)})).start():f(o).to(.1,{scale:new d(1.5,1.5,1)}).to(.1,{scale:new d(1,1,1)}).parallel(f().by(.8*n,{position:new d(.7*c,.7*l,0)}),f().by(.3*n,{angle:.5*h}),f(r).delay(u).to(m,{opacity:0})).call((function(){t.removeDamageNumber(e)})).start(),this._activeTweens.push(i),this.scheduleOnce((function(){t._activeDamageNumbers.has(e)&&t.removeDamageNumber(e)}),n+.5)}else this._activeDamageNumbers.delete(e)},s.showMultiHitDamage=function(e,t,a){var i="è¿å‡»"+t+"/"+a+" -"+e,o=new u(200,100,255);this.createFloatingText(i,o,this.normalFontSize)},s.showSkillDamage=function(e,t){var a=t+" -"+e,i=new u(0,200,255);this.createFloatingText(a,i,this.aoeFontSize)},s.clearAllDamageNumbers=function(){for(var e,t=r(this._activeDamageNumbers);!(e=t()).done;){var a=e.value,i=(a[0],a[1]);i.node&&cc.isValid(i.node)&&i.node.destroy()}this._activeDamageNumbers.clear(),this._lastDamagePositions=[]},s.isDead=function(){return this._currentHealth<=0},s.setTargetNode=function(e){this._targetNode=e},s.isValidTarget=function(e){return e&&e.node&&e.node.isValid},s.clearAllTweens=function(){for(var e,t=r(this._activeTweens);!(e=t()).done;){var a=e.value;try{a&&a.stop&&a.stop()}catch(e){}}this._activeTweens=[]},n(t,[{key:"currentHealth",get:function(){return this._currentHealth}},{key:"maxHealth",get:function(){return this._maxHealth}}]),t}(v)).prototype,"healthBar",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=t(L.prototype,"healthText",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=t(L.prototype,"damageEffectBar",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=t(L.prototype,"animationDuration",[le],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.3}}),j=t(L.prototype,"normalDamageColor",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new u(255,255,0)}}),K=t(L.prototype,"critDamageColor",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new u(255,50,50)}}),Q=t(L.prototype,"healColor",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new u(50,255,50)}}),U=t(L.prototype,"aoeDamageColor",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new u(255,165,0)}}),G=t(L.prototype,"critFontSize",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 32}}),J=t(L.prototype,"normalFontSize",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 40}}),Y=t(L.prototype,"aoeFontSize",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 28}}),Z=t(L.prototype,"critEffectSprite",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$=t(L.prototype,"damageAreaWidth",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 200}}),ee=t(L.prototype,"damageAreaHeight",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 150}}),te=t(L.prototype,"damageDisplayDuration",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.05}}),ae=t(L.prototype,"damageVerticalSpacing",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 45}}),ie=t(L.prototype,"maxDamageNumbers",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 8}}),oe=t(L.prototype,"horizontalSpread",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 300}}),re=t(L.prototype,"verticalSpread",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 200}}),ne=t(L.prototype,"baseVerticalPosition",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 80}}),I=L))||I));s._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./AudioManager.ts","./BackgroundScroller.ts","./EnemySpawner.ts","./EquipManager.ts","./ExperienceManager.ts","./GameManager.ts","./DebugComponent.ts","./GameMode.ts","./UnitSpawnedRouter.ts","./UnitSpawner.ts","./HealthBar.ts","./Monster.ts","./OpenURL.ts","./PlayerController.ts","./ProgressTrigger.ts","./SimpleFingerAnimation.ts","./SimpleParallaxTest.ts","./SlotsMachine.ts","./SpriteAnimation.ts","./EquipmentData.ts","./EquipmentDetailPopup.ts","./EquipmentItem.ts","./EquipmentSlot.ts","./popRewardWin.ts","./startLayer.ts","./SafeAnimationHelper.ts"],(function(){return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/Monster.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AudioManager.ts","./HealthBar.ts"],(function(t){var i,e,n,o,s,a,l,r,h,c,p,u,f,m;return{setters:[function(t){i=t.inheritsLoose,e=t.createClass,n=t.applyDecoratedDescriptor,o=t.initializerDefineProperty,s=t.assertThisInitialized},function(t){a=t.cclegacy,l=t.BoxCollider2D,r=t.Prefab,h=t.sp,c=t.instantiate,p=t.Node,u=t.Contact2DType},function(t){f=t.AudioManager},function(t){m=t.HealthBar}],execute:function(){var d,g,k,C,b,S,y,v,A,x,M,D,P,B,H,w,z,T,_,L,E,N,F,I,X,O,V,G,R,J,j,q,U,K,Q,W,Y,Z,$,tt,it,et,nt,ot;a._RF.push({},"b0b87niMBxH9b3PJJvUu1qv","Monster",void 0);var st=cc._decorator,at=st.ccclass,lt=st.property;t("default",(d=lt(cc.Component),g=lt(cc.Component),k=lt(cc.Component),C=lt(cc.Node),b=lt(l),S=lt({type:cc.Float}),y=lt({type:cc.Float}),v=lt({type:cc.Float}),A=lt(cc.Size),x=lt(cc.Vec2),M=lt({type:cc.Float,tooltip:"æ”»å‡»æ£€æµ‹èŒƒå›´"}),D=lt({type:cc.Float,tooltip:"åœæ­¢ç§»åŠ¨çš„è·ç¦»"}),P=lt({type:cc.Float,tooltip:"æ”»å‡»é—´éš”ï¼ˆç§’ï¼‰"}),B=lt(r),H=lt(h.SkeletonData),w=lt(h.SkeletonData),z=lt(h.SkeletonData),T=lt(h.SkeletonData),_=lt(h.SkeletonData),L=lt({type:cc.Boolean}),at((N=function(t){function n(){for(var i,e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return i=t.call.apply(t,[this].concat(n))||this,o(i,"spineComponent",F,s(i)),o(i,"spineComponent1",I,s(i)),o(i,"spineComponent2",X,s(i)),o(i,"spineNode",O,s(i)),o(i,"boxCollider",V,s(i)),o(i,"moveSpeed",G,s(i)),o(i,"health",R,s(i)),o(i,"attackDamage",J,s(i)),o(i,"colliderSize",j,s(i)),o(i,"colliderOffset",q,s(i)),o(i,"attackRange",U,s(i)),o(i,"stopDistance",K,s(i)),o(i,"attackInterval",Q,s(i)),o(i,"maxHealth",W,s(i)),o(i,"healthBarPrefab",Y,s(i)),o(i,"healthBarOffset",Z,s(i)),o(i,"bossSkillComponent1",$,s(i)),o(i,"bossSkillComponent2",tt,s(i)),o(i,"bossSkillComponent3",it,s(i)),o(i,"bossSkillComponent4",et,s(i)),o(i,"bossSkillComponent5",nt,s(i)),i.skillSpine1=null,i.skillSpine2=null,i.skillSpine3=null,i.skillSpine4=null,i.skillSpine5=null,i.isMoving=!0,i.isAttacking=!1,i.isTakingHit=!1,i.targetPlayer=null,i.screenCenter=0,i.currentHealth=0,i.spineAvailable=!1,i.lastAttackTime=0,i.isInCombat=!1,i.healthBar=null,i.httEffArr=[],i.doDamageNum=0,i.randomX1=0,i.randomX2=0,i.randomX3=0,i.randomX4=0,o(i,"debugMode",ot,s(i)),i}i(n,t);var a=n.prototype;return a.onLoad=function(){this.screenCenter=0,this.currentHealth=this.health,this.initSpineComponent(),this.initCollider(),this.initHealthBar(),this.log("Monster åŠ è½½å®Œæˆï¼Œåˆå§‹ä½ç½®:",this.node.position)},a.initHealthBar=function(){if(this.healthBarPrefab){var t=c(this.healthBarPrefab);this.node.addChild(t),t.setPosition(0,this.healthBarOffset,0),this.healthBar=t.getComponentInChildren(m),this.healthBar?(this.healthBar.init(this.maxHealth,this.currentHealth),console.log("è¡€æ¡åˆå§‹åŒ–æˆåŠŸ")):(console.error("HealthBar component not found on prefab!"),t.destroy())}else console.error("HealthBar prefab is not assigned!")},a.initSpineComponent=function(){var t=this;if(this.spineNode){this.spineComponent=this.spineComponent.getComponent("sp.Skeleton"),this.spineComponent1=this.spineComponent1.getComponent("sp.Skeleton"),this.spineComponent2=this.spineComponent2.getComponent("sp.Skeleton");var i=new p("SpineCharacter1");this.skillSpine1=i.addComponent(h.Skeleton),i.setParent(this.node);var e=new p("SpineCharacter2");this.skillSpine2=e.addComponent(h.Skeleton),e.setParent(this.node);var n=new p("SpineCharacter3");this.skillSpine3=n.addComponent(h.Skeleton),n.setParent(this.node);var o=new p("SpineCharacter4");this.skillSpine4=o.addComponent(h.Skeleton),o.setParent(this.node);var s=new p("SpineCharacter4");if(this.skillSpine5=s.addComponent(h.Skeleton),s.setParent(this.node),i.active=!1,e.active=!1,n.active=!1,o.active=!1,s.active=!1,i.scale=new cc.Vec3(.8,.8,.8),n.scale=new cc.Vec3(.8,.8,.8),o.scale=new cc.Vec3(.8,.8,.8),s.scale=new cc.Vec3(.8,.8,.8),this.skillSpine1.skeletonData=this.bossSkillComponent1,this.skillSpine2.skeletonData=this.bossSkillComponent2,this.skillSpine3.skeletonData=this.bossSkillComponent3,this.skillSpine4.skeletonData=this.bossSkillComponent4,this.skillSpine5.skeletonData=this.bossSkillComponent5,this.skillSpine1.setCompleteListener((function(i){f.instance.playSound("skill_firecircle_ground"),console.log("åŠ¨ç”»ç»“æŸ:",i.animation.name),t.skillSpine2.node.active=!0,t.skillSpine2.setAnimation(0,"action",!1),t.skillSpine2.node.x=t.randomX1})),this.skillSpine3.setCompleteListener((function(i){f.instance.playSound("skill_firecircle_ground"),console.log("åŠ¨ç”»ç»“æŸ:",i.animation.name),t.skillSpine2.node.active=!0,t.skillSpine2.setAnimation(0,"action",!1),t.skillSpine2.node.x=t.randomX2})),this.skillSpine4.setCompleteListener((function(i){f.instance.playSound("skill_firecircle_ground"),console.log("åŠ¨ç”»ç»“æŸ:",i.animation.name),t.skillSpine2.node.active=!0,t.skillSpine2.setAnimation(0,"action",!1),t.skillSpine2.node.x=t.randomX3})),this.skillSpine5.setCompleteListener((function(i){f.instance.playSound("skill_firecircle_ground"),console.log("åŠ¨ç”»ç»“æŸ:",i.animation.name),t.skillSpine2.node.active=!0,t.skillSpine2.setAnimation(0,"action",!1),t.skillSpine2.node.x=t.randomX4})),this.httEffArr.push(this.spineComponent1),this.httEffArr.push(this.spineComponent2),this.spineComponent)return this.log("ä» spineNode æ‰¾åˆ° Spine ç»„ä»¶"),void(this.spineAvailable=!0)}this.log("Spine ç»„ä»¶æœªæ‰¾åˆ°ï¼Œå°†ä½¿ç”¨åŸºç¡€é€»è¾‘"),this.spineAvailable=!1},a.initCollider=function(){if(this.boxCollider)this.log("ä½¿ç”¨æ‰‹åŠ¨è®¾ç½®çš„ç¢°æ’ä½“");else if(this.boxCollider=this.getComponent(l),!this.boxCollider)for(var t=this.node.children,i=0;i<t.length;i++){var e=t[i],n=e.getComponent(l);if(n){this.log("åœ¨å­èŠ‚ç‚¹æ‰¾åˆ°ç¢°æ’ä½“:",e.name),this.boxCollider=n;break}}this.boxCollider||(this.log("æœªæ‰¾åˆ°ç¢°æ’ä½“ï¼Œè‡ªåŠ¨æ·»åŠ  BoxCollider"),this.boxCollider=this.addComponent(l)),this.setupCollider()},a.setupCollider=function(){this.boxCollider&&(this.colliderSize.width>0&&this.colliderSize.height>0&&(this.boxCollider.size=this.colliderSize),this.colliderOffset&&(this.boxCollider.offset=this.colliderOffset),this.boxCollider.sensor=!0,this.log("ç¢°æ’ä½“è®¾ç½®å®Œæˆï¼Œå¤§å°:",this.boxCollider.size),this.boxCollider.enabled=!0,this.boxCollider&&(this.boxCollider.on(u.BEGIN_CONTACT,this.onBeginContact,this),this.boxCollider.on(u.END_CONTACT,this.onEndContact,this)))},a.setGameManager=function(t){this.gameManager=t},a.start=function(){this.spineAvailable?this.playMoveAnimation():this.log("Spine ä¸å¯ç”¨ï¼Œä½¿ç”¨åŸºç¡€ç§»åŠ¨"),this.findPlayer(),this.healthBar||this.initHealthBar(),this.lastAttackTime=Date.now()},a.update=function(t){this.isAlive()&&(this.isMoving?this.moveTowardsCenter(t):this.isAttacking&&this.targetPlayer&&this.faceTarget(),this.isInCombat&&this.canAttack()&&this.executeAttack(),!this.isAttacking&&this.targetPlayer&&this.checkAttackRange())},a.moveTowardsCenter=function(t){var i=this.screenCenter-this.stopDistance;if(this.node.position.x>i){var e=this.node.position.x-this.moveSpeed*t;this.node.setPosition(e,this.node.position.y),this.node.scaleX=Math.abs(this.node.scaleX),this.node.position.x<=i&&(this.node.setPosition(i,this.node.position.y),this.stopMoving(),this.log("åˆ°è¾¾ç›®æ ‡ä½ç½®ï¼Œåœæ­¢ç§»åŠ¨"))}else this.stopMoving()},a.checkAttackRange=function(){if(this.targetPlayer&&this.targetPlayer.isValid){var t=Math.abs(this.node.position.x-this.targetPlayer.position.x);t<=this.attackRange&&(this.log("ç©å®¶åœ¨æ”»å‡»èŒƒå›´å†…ï¼Œè·ç¦»: "+t),this.enterCombat(this.targetPlayer))}},a.playMoveAnimation=function(){this.log("æ’­æ”¾ç§»åŠ¨åŠ¨ç”»"),this.safeSpineCall("setAnimation",0,"Move",!0)||this.log("ç§»åŠ¨åŠ¨ç”»æ’­æ”¾å¤±è´¥")},a.playIdleAnimation=function(){this.log("æ’­æ”¾å¾…æœºåŠ¨ç”»"),this.safeSpineCall("setAnimation",0,"Idle",!0)||this.log("å¾…æœºåŠ¨ç”»æ’­æ”¾å¤±è´¥")},a.playAttackAnimation=function(){var t=this;this.log("æ’­æ”¾æ”»å‡»åŠ¨ç”»");var i=["atk","atkb","atk2","atkc"][Math.floor(4*Math.random())];this.safeSpineCall("setAnimation",0,i,!1)?this.spine.setCompleteListener&&this.spine.setCompleteListener(this.onSpineAnimationComplete.bind(this)):(this.log("æ”»å‡»åŠ¨ç”»æ’­æ”¾å¤±è´¥ï¼Œä½¿ç”¨å®šæ—¶å™¨"),this.scheduleOnce((function(){return t.onAttackFinished()}),.5))},a.playHitAnimation=function(){var t=this;if(this.log("æ’­æ”¾å—å‡»åŠ¨ç”»"),this.safeSpineCall("setAnimation",0,"Hurt",!1)){if(this.httEffArr){for(var i=0;i<this.httEffArr.length;i++)this.httEffArr[i].node.active=!1;var e=this.httEffArr[Math.floor(Math.random()*this.httEffArr.length)];e.node.active=!0,e.setAnimation(0,"Hit",!1)}this.spine.setCompleteListener&&this.spine.setCompleteListener(this.onSpineAnimationComplete.bind(this))}else this.scheduleOnce((function(){return t.onHitFinished()}),.3)},a.playDeathAnimation=function(){this.log("æ’­æ”¾æ­»äº¡åŠ¨ç”»"),this.safeSpineCall("setAnimation",0,"Death",!1)},a.bossSkillAnimation1=function(){this.log("æ’­æ”¾bossæ”»å‡»åŠ¨ç”»"),f.instance.playSound("skill_firecircle_fly"),this.skillSpine1.node.active=!0,this.skillSpine1.setAnimation(0,"action",!1);var t=this.skillSpine1.node.scale;this.skillSpine1.node.setScale(-1,t.y,t.z);var i=Math.floor(300*Math.random())-300;this.skillSpine1.node.x=i,this.randomX1=i},a.bossSkillAnimation3=function(){this.log("æ’­æ”¾bossæ”»å‡»åŠ¨ç”»"),f.instance.playSound("skill_firecircle_fly"),this.skillSpine3.node.active=!0,this.skillSpine3.setAnimation(0,"action",!1);var t=this.skillSpine1.node.scale;this.skillSpine3.node.setScale(-1,t.y,t.z);var i=Math.floor(300*Math.random())-300;this.skillSpine3.node.x=i,this.randomX2=i},a.bossSkillAnimation4=function(){this.log("æ’­æ”¾bossæ”»å‡»åŠ¨ç”»"),f.instance.playSound("skill_firecircle_fly"),this.skillSpine4.node.active=!0,this.skillSpine4.setAnimation(0,"action",!1);var t=this.skillSpine1.node.scale;this.skillSpine4.node.setScale(-1,t.y,t.z);var i=Math.floor(300*Math.random());this.skillSpine4.node.x=i,this.randomX3=i},a.bossSkillAnimation5=function(){this.log("æ’­æ”¾bossæ”»å‡»åŠ¨ç”»"),f.instance.playSound("skill_firecircle_fly"),this.skillSpine5.node.active=!0,this.skillSpine5.setAnimation(0,"action",!1);var t=this.skillSpine1.node.scale;this.skillSpine5.node.setScale(-1,t.y,t.z);var i=Math.floor(300*Math.random());this.skillSpine5.node.x=i,this.randomX4=i},a.onSpineAnimationComplete=function(t){if(t&&t.animation){var i=t.animation.name;this.log("Spine åŠ¨ç”»å®Œæˆ: "+i),"atk"===i?this.onAttackFinished():"Hurt"===i?this.onHitFinished():"action"===i&&this.onBossHitFinished()}},a.stopMoving=function(){this.isMoving=!1,this.playIdleAnimation()},a.findPlayer=function(){this.targetPlayer=cc.find("Canvas/characterLayer")||cc.find("characterLayer")||cc.find("characterLayer1"),this.targetPlayer?this.log("æ‰¾åˆ°ç©å®¶:",this.targetPlayer.name):this.log("æœªæ‰¾åˆ°ç©å®¶èŠ‚ç‚¹")},a.enterCombat=function(t){if(this.isTakingHit||!this.isAlive())return this.log("æ— æ³•è¿›å…¥æˆ˜æ–—ï¼Œæ¡ä»¶ä¸æ»¡è¶³"),void(this.isMoving=!1);this.isInCombat=!0,this.isMoving=!1,this.isAttacking=!0,this.targetPlayer=t,this.log("è¿›å…¥æˆ˜æ–—çŠ¶æ€"),this.playIdleAnimation(),this.executeAttack()},a.exitCombat=function(){this.isInCombat=!1,this.isAttacking=!1,this.log("é€€å‡ºæˆ˜æ–—çŠ¶æ€"),this.hasSpine()&&this.spine.setCompleteListener&&this.spine.setCompleteListener(null),this.isAlive()&&!this.isTakingHit&&(this.isMoving=!0,this.playMoveAnimation())},a.canAttack=function(){return Date.now()-this.lastAttackTime>=1e3*this.attackInterval},a.executeAttack=function(){if(this.canAttack()&&this.isInCombat&&this.targetPlayer&&this.targetPlayer.isValid){this.log("æ‰§è¡Œæ”»å‡»"),this.lastAttackTime=Date.now();var t=this.targetPlayer.getComponent("PlayerController");t.isAlive()&&this.playAttackAnimation(),this.isAlive()&&t&&"function"==typeof t.takeDamage&&(t.takeDamage(this.attackDamage),this.log("å¯¹ç©å®¶é€ æˆ "+this.attackDamage+" ä¼¤å®³"))}},a.onAttackFinished=function(){this.log("æ”»å‡»åŠ¨ç”»å®Œæˆ")},a.takeDamage=function(t,i,e){if(void 0===i&&(i=!1),void 0===e&&(e=!1),this.isAlive()){this.currentHealth-=t,this.log("å—åˆ° "+t+" ä¼¤å®³ï¼Œå‰©ä½™ç”Ÿå‘½: "+this.currentHealth),this.isTakingHit=!0,this.exitCombat();var n=cc.find("Canvas");if(n){var o=n.getComponent("GameManager");if(o&&"function"==typeof o.getCurrentLevel)if(4==o.getCurrentLevel()){if(this.executeAttack(),this.doDamageNum++,this.doDamageNum>=2&&(this.isTakingHit=!1,this.doDamageNum=0,this.executeAttack()),this.httEffArr){for(var s=0;s<this.httEffArr.length;s++)this.httEffArr[s].node.active=!1;this.httEffArr[Math.floor(Math.random()*this.httEffArr.length)].node.active=!0}}else this.playHitAnimation()}this.healthBar&&this.healthBar.takeDamage(t,i,e),this.currentHealth<=0&&this.die()}},a.onHitFinished=function(){(this.log("å—å‡»å®Œæˆ"),this.isTakingHit=!1,this.isAlive())&&(this.targetPlayer&&this.targetPlayer.isValid&&Math.abs(this.node.position.x-this.targetPlayer.position.x)<=this.attackRange?this.enterCombat(this.targetPlayer):(this.isMoving=!0,this.playMoveAnimation()))},a.onBossHitFinished=function(){if(this.log("bossç‰¹æ•ˆå®Œæˆ"),this.isTakingHit=!1,this.bossSkillComponent2.getComponent("sp.Skeleton").setAnimation(0,"action",!1),this.isAlive()){var t=this.targetPlayer.getComponent("PlayerController");t&&"function"==typeof t.takeDamage&&(t.takeDamage(this.attackDamage),this.log("å¯¹ç©å®¶é€ æˆ "+this.attackDamage+" ä¼¤å®³"))}},a.die=function(){var t=this;this.log("æ€ªç‰©æ­»äº¡"),this.exitCombat(),this.isMoving=!1,this.playDeathAnimation(),f.instance.playSound("monster_hurt"),this.boxCollider&&(this.boxCollider.enabled=!1),this.notifyGameManager(),this.scheduleOnce((function(){t.node&&t.node.isValid&&t.node.destroy()}),1)},a.notifyGameManager=function(){try{var t=cc.find("Canvas");if(t){var i=t.getComponent("GameManager");i&&"function"==typeof i.onMonsterDied&&i.onMonsterDied(this.node)}}catch(t){this.log("é€šçŸ¥ GameManager å¤±è´¥: "+t)}},a.faceTarget=function(){if(this.targetPlayer&&this.targetPlayer.isValid){var t=Math.abs(this.node.scaleX);this.node.scaleX=this.targetPlayer.position.x<this.node.position.x?t:-t}},a.onBeginContact=function(t,i){if(this.log("ç¢°æ’å¼€å§‹: "+i.node.name),"player"===i.node.group||"Player"===i.node.name){var e=i.node;e.getComponent("Player")&&this.isAlive()&&(this.log("ä¸ç©å®¶ç¢°æ’ï¼Œè¿›å…¥æˆ˜æ–—"),this.enterCombat(e))}},a.onEndContact=function(t,i){this.log("ç¢°æ’ç»“æŸ: "+i.node.name),"player"!==i.node.group&&"Player"!==i.node.name||(this.log("ä¸ç©å®¶åˆ†ç¦»ï¼Œé€€å‡ºæˆ˜æ–—"),this.exitCombat())},a.hasSpine=function(){return this.spineAvailable&&this.spineComponent&&this.spineComponent.isValid},a.hasBossSpine1=function(){return this.bossSkillComponent1&&this.bossSkillComponent1.isValid},a.safeSpineCall=function(t){if(!this.hasSpine())return!1;try{if(this.spine[t]&&"function"==typeof this.spine[t]){for(var i,e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];return(i=this.spine)[t].apply(i,n),!0}}catch(i){this.log("è°ƒç”¨ Spine æ–¹æ³• "+t+" å¤±è´¥: "+i)}return!1},a.safeBossSpineCall=function(t){if(!this.hasBossSpine1())return!1;try{if(this.spineBoss[t]&&"function"==typeof this.spineBoss[t]){for(var i,e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];return(i=this.spineBoss)[t].apply(i,n),!0}}catch(i){this.log("è°ƒç”¨ Spine æ–¹æ³• "+t+" å¤±è´¥: "+i)}return!1},a.setMaxHealth=function(t){this.maxHealth=t,this.currentHealth=this.maxHealth,this.healthBar.init(this.maxHealth,this.currentHealth),console.log("æ€ªç‰©è¡€é‡è®¾ç½®ä¸º: "+this.maxHealth)},a.isAlive=function(){return this.currentHealth>0},a.log=function(t,i){void 0===i&&(i=!0),(this.debugMode||i)&&console.log("[Monster] "+t)},a.onDestroy=function(){this.hasSpine()&&this.spine.setCompleteListener&&this.spine.setCompleteListener(null),this.hasBossSpine1()&&this.spineBoss.setCompleteListener&&this.spineBoss.setCompleteListener(null),this.unscheduleAllCallbacks(),this.boxCollider&&(this.boxCollider.off(u.BEGIN_CONTACT,this.onBeginContact,this),this.boxCollider.off(u.END_CONTACT,this.onEndContact,this))},e(n,[{key:"spine",get:function(){return this.spineComponent}},{key:"spineBoss",get:function(){return this.bossSkillComponent1}},{key:"spine1",get:function(){return this.spineComponent1}}]),n}(cc.Component),F=n(N.prototype,"spineComponent",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=n(N.prototype,"spineComponent1",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),X=n(N.prototype,"spineComponent2",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=n(N.prototype,"spineNode",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=n(N.prototype,"boxCollider",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=n(N.prototype,"moveSpeed",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 80}}),R=n(N.prototype,"health",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1e5}}),J=n(N.prototype,"attackDamage",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),j=n(N.prototype,"colliderSize",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return cc.size(100,100)}}),q=n(N.prototype,"colliderOffset",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return cc.v2(0,0)}}),U=n(N.prototype,"attackRange",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 150}}),K=n(N.prototype,"stopDistance",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 100}}),Q=n(N.prototype,"attackInterval",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 2}}),W=n(N.prototype,"maxHealth",[lt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1e5}}),Y=n(N.prototype,"healthBarPrefab",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Z=n(N.prototype,"healthBarOffset",[lt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 150}}),$=n(N.prototype,"bossSkillComponent1",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),tt=n(N.prototype,"bossSkillComponent2",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),it=n(N.prototype,"bossSkillComponent3",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),et=n(N.prototype,"bossSkillComponent4",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),nt=n(N.prototype,"bossSkillComponent5",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ot=n(N.prototype,"debugMode",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),E=N))||E));a._RF.pop()}}}));

System.register("chunks:///_virtual/OpenURL.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AudioManager.ts"],(function(t){var n,e,r,i,o,u,a,c,l,p;return{setters:[function(t){n=t.applyDecoratedDescriptor,e=t.inheritsLoose,r=t.initializerDefineProperty,i=t.assertThisInitialized},function(t){o=t.cclegacy,u=t._decorator,a=t.Node,c=t.Button,l=t.Component},function(t){p=t.AudioManager}],execute:function(){var s,f,h,b,y,d,g;o._RF.push({},"26fc8ak0n5PUYOH7Koz47nE","OpenURL",void 0);var v=u.ccclass,L=u.property;t("OpenURL",(s=v("OpenURL"),f=L(String),h=L(a),s((d=n((y=function(t){function n(){for(var n,e=arguments.length,o=new Array(e),u=0;u<e;u++)o[u]=arguments[u];return n=t.call.apply(t,[this].concat(o))||this,r(n,"url",d,i(n)),r(n,"button",g,i(n)),n}e(n,t);var o=n.prototype;return o.start=function(){this.button&&this.button.on(c.EventType.CLICK,this.openURL,this)},o.openURL=function(){this.url&&""!==this.url&&(p.instance.playSound("voc_click",.8),window.open(this.url,"_blank"))},n}(l)).prototype,"url",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"https://www.baidu.com"}}),g=n(y.prototype,"button",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=y))||b));o._RF.pop()}}}));

System.register("chunks:///_virtual/PlayerController.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SimpleParallaxTest.ts","./HealthBar.ts","./AudioManager.ts"],(function(t){var i,e,n,o,a,s,l,r,h,c,u,p;return{setters:[function(t){i=t.inheritsLoose,e=t.createClass,n=t.applyDecoratedDescriptor,o=t.initializerDefineProperty,a=t.assertThisInitialized},function(t){s=t.cclegacy,l=t.BoxCollider2D,r=t.Contact2DType,h=t.ProgressBar},function(t){c=t.SimpleParallaxTest},function(t){u=t.HealthBar},function(t){p=t.AudioManager}],execute:function(){var m,g,f,d,v,b,A,C,k,y,M,H,S,N,T,w,x,D,I,z,P,B,L,E,_,F,R,O,U,V,G,q,j,J,K,Q,W,X,Y,Z,$,tt,it,et,nt,ot,at,st,lt,rt,ht,ct,ut,pt,mt,gt,ft,dt,vt;s._RF.push({},"2c4e19/Bu9MKLC8FdqJsmq3","PlayerController",void 0);var bt=cc._decorator,At=bt.ccclass,Ct=bt.property;t("default",(m=Ct(cc.Component),g=Ct(cc.Node),f=Ct(l),d=Ct({type:cc.Float}),v=Ct({type:cc.Float}),b=Ct({type:cc.Float}),A=Ct(cc.Size),C=Ct(cc.Vec2),k=Ct({type:cc.Float,tooltip:"æ”»å‡»æ£€æµ‹èŒƒå›´"}),y=Ct({type:cc.Float,tooltip:"æ”»å‡»é—´éš”ï¼ˆç§’ï¼‰"}),M=Ct({type:cc.String,tooltip:"ç§»åŠ¨åŠ¨ç”»åç§°"}),H=Ct({type:cc.String,tooltip:"å¾…æœºåŠ¨ç”»åç§°"}),S=Ct({type:cc.String,tooltip:"æ”»å‡»åŠ¨ç”»åç§°"}),N=Ct({type:cc.String,tooltip:"å—å‡»åŠ¨ç”»åç§°"}),T=Ct({type:cc.String,tooltip:"æ­»äº¡åŠ¨ç”»åç§°"}),w=Ct(cc.Node),x=Ct(cc.Node),D=Ct({type:cc.Float,tooltip:"æ¯æ¬¡ç§»åŠ¨çš„è·ç¦»"}),I=Ct(cc.Node),z=Ct({type:cc.Float,tooltip:"AOEæ”»å‡»èŒƒå›´"}),P=Ct({type:cc.Float,tooltip:"æš´å‡»ç‡ (0-1)"}),B=Ct({type:cc.Float,tooltip:"æš´å‡»ä¼¤å®³å€æ•°"}),L=Ct({type:cc.Boolean,tooltip:"æ˜¯å¦å¯ç”¨å¤šæ®µä¼¤å®³"}),E=Ct({type:cc.Integer,tooltip:"å¤šæ®µä¼¤å®³æ¬¡æ•°"}),_=Ct({type:cc.Float,tooltip:"å¤šæ®µä¼¤å®³é—´éš”(ç§’)"}),F=Ct({type:cc.Float,tooltip:"å¤šæ®µä¼¤å®³é€’å‡æ¯”ä¾‹"}),R=Ct(cc.Node),O=Ct({type:cc.Boolean}),At((V=function(t){function n(){for(var i,e=arguments.length,n=new Array(e),s=0;s<e;s++)n[s]=arguments[s];return i=t.call.apply(t,[this].concat(n))||this,o(i,"spineComponent",G,a(i)),o(i,"spineNode",q,a(i)),o(i,"boxCollider",j,a(i)),o(i,"moveSpeed",J,a(i)),o(i,"maxHealth",K,a(i)),o(i,"health",Q,a(i)),o(i,"attackDamage",W,a(i)),o(i,"colliderSize",X,a(i)),o(i,"colliderOffset",Y,a(i)),o(i,"attackRange",Z,a(i)),o(i,"attackInterval",$,a(i)),o(i,"moveAnimationName",tt,a(i)),o(i,"idleAnimationName",it,a(i)),o(i,"attackAnimationName",et,a(i)),o(i,"hurtAnimationName",nt,a(i)),o(i,"deathAnimationName",ot,a(i)),o(i,"moveButton",at,a(i)),o(i,"autoEffNode",st,a(i)),o(i,"moveDistance",lt,a(i)),o(i,"levelUpSpine",rt,a(i)),o(i,"aoeRange",ht,a(i)),o(i,"critRate",ct,a(i)),o(i,"critMultiplier",ut,a(i)),o(i,"enableMultiHit",pt,a(i)),o(i,"multiHitCount",mt,a(i)),o(i,"multiHitInterval",gt,a(i)),o(i,"multiHitDamageReduction",ft,a(i)),o(i,"healthBarNode",dt,a(i)),i.isMoving=!1,i.isAttacking=!1,i.isTakingHit=!1,i.targetMonster=null,i.currentHealth=0,i.spineAvailable=!1,i.lastAttackTime=0,i.isInCombat=!1,i.targetPosition=null,i.moveTween=null,i.healthBar=null,i._attackPower=10,i._maxHealth=100,i._currentHealth=100,i.firstEnter=!0,i.attackAnimationNameArr=[],i.multiHitTimer=null,i.currentHitCount=0,i.isMultiHitActive=!1,i.currentAttackAnimation="",i.doDamageNum=0,o(i,"debugMode",vt,a(i)),i}i(n,t);var s=n.prototype;return s.getParallaxTest=function(){var t,i=null==(t=this.node.parent)?void 0:t.getChildByName("test");return(null==i?void 0:i.getComponent(c))||null},s.onLoad=function(){this.currentHealth=this.health,this.healthBar=this.getComponentInChildren(u),this.healthBar&&this.healthBar.init(this.maxHealth,this.currentHealth),this.levelUpSpine&&(this.levelUpSpine.active=!1);var t=cc.find("Canvas");t&&(this.gameManager=t.getComponent("GameManager")),this.initSpineComponent(),this.initCollider(),this.setupButtonEvents(),this.node.on("player-skill-upgraded",this.onSkillUpgraded,this),this.log("Player åŠ è½½å®Œæˆ"),this.attackAnimationNameArr.push(this.attackAnimationName),this.attackAnimationNameArr.push("atk3g"),this.attackAnimationNameArr.push("atk2")},s.onSkillUpgraded=function(t,i){this.attackAnimationName=t,this.attackAnimationNameArr.push(t),this.attackInterval=i},s.initSpineComponent=function(){if(this.spineComponent)return this.log("ä½¿ç”¨æ‰‹åŠ¨è®¾ç½®çš„ Spine ç»„ä»¶"),this.spineAvailable=!0,void this.debugSpineInfo();if(this.spineNode&&(this.spineComponent=this.spineNode.getComponent("sp.Skeleton"),this.spineComponent))return this.log("ä» spineNode æ‰¾åˆ° Spine ç»„ä»¶"),this.spineAvailable=!0,void this.debugSpineInfo();if(this.spineComponent=this.node.getComponent("sp.Skeleton"),this.spineComponent)return this.log("åœ¨å½“å‰èŠ‚ç‚¹æ‰¾åˆ° Spine ç»„ä»¶"),this.spineAvailable=!0,void this.debugSpineInfo();for(var t=this.node.children,i=0;i<t.length;i++){var e=t[i],n=e.getComponent("sp.Skeleton");if(n)return this.spineComponent=n,this.log("åœ¨å­èŠ‚ç‚¹æ‰¾åˆ° Spine ç»„ä»¶:",e.name),this.spineAvailable=!0,void this.debugSpineInfo()}this.log("Spine ç»„ä»¶æœªæ‰¾åˆ°ï¼Œå°†ä½¿ç”¨åŸºç¡€é€»è¾‘"),this.spineAvailable=!1},s.debugSpineInfo=function(){if(this.hasSpine())try{var t=this.spine.skeletonData;if(t&&(this.log("Spine èµ„æº: "+t.name),t.anims)){for(var i=[],e=0;e<t.anims.length;e++)i.push(t.anims[e].name);this.log("å¯ç”¨åŠ¨ç”»: "+i.join(", "))}}catch(t){this.log("è°ƒè¯•Spineä¿¡æ¯æ—¶å‡ºé”™: "+t)}},s.initCollider=function(){if(this.boxCollider)this.log("ä½¿ç”¨æ‰‹åŠ¨è®¾ç½®çš„ç¢°æ’ä½“");else if(this.boxCollider=this.getComponent(l),!this.boxCollider)for(var t=this.node.children,i=0;i<t.length;i++){var e=t[i],n=e.getComponent(l);if(n){this.log("åœ¨å­èŠ‚ç‚¹æ‰¾åˆ°ç¢°æ’ä½“:",e.name),this.boxCollider=n;break}}this.boxCollider||(this.log("æœªæ‰¾åˆ°ç¢°æ’ä½“ï¼Œè‡ªåŠ¨æ·»åŠ  BoxCollider"),this.boxCollider=this.addComponent(l)),this.setupCollider()},s.setupCollider=function(){this.boxCollider&&(this.colliderSize.width>0&&this.colliderSize.height>0&&(this.boxCollider.size=this.colliderSize),this.colliderOffset&&(this.boxCollider.offset=this.colliderOffset),this.boxCollider.sensor=!0,this.log("ç¢°æ’ä½“è®¾ç½®å®Œæˆï¼Œå¤§å°:",this.boxCollider.size),this.boxCollider.enabled=!0,this.boxCollider&&(this.boxCollider.on(r.BEGIN_CONTACT,this.onBeginContact,this),this.boxCollider.on(r.END_CONTACT,this.onEndContact,this)))},s.setupButtonEvents=function(){this.moveButton?(this.moveButton.on(cc.Node.EventType.TOUCH_START,this.onMoveButtonClick,this),this.log("ç§»åŠ¨æŒ‰é’®äº‹ä»¶æ³¨å†Œå®Œæˆ")):this.log("æœªæ‰¾åˆ°ç§»åŠ¨æŒ‰é’®")},s.start=function(){this.spineAvailable?this.playIdleAnimation():this.log("Spine ä¸å¯ç”¨ï¼Œä½¿ç”¨åŸºç¡€é€»è¾‘"),this.findMonster(),this.lastAttackTime=Date.now()},s.update=function(t){this.isAlive()&&(this.targetMonster&&this.targetMonster.isValid||this.findMonster(),this.isInCombat&&this.canAttack()&&this.targetMonster&&this.checkAttackRange(),this.targetMonster&&this.isMoving&&!this.isAttacking&&this.targetMonster&&this.checkAttackRange())},s.checkAttackRange=function(){var t=this;if(this.targetMonster&&this.targetMonster.isValid){var i=cc.find("Canvas"),e=i.getComponent("GameManager");if(i&&e&&"function"==typeof e.getCurrentLevel){var n=e.getCurrentLevel();4==n&&(this.attackRange=270);var o=Math.abs(this.node.position.x-this.targetMonster.position.x);o<=this.attackRange?(this.log("ç©å®¶åœ¨æ”»å‡»èŒƒå›´å†…ï¼Œè·ç¦»: "+o),4==n&&this.firstEnter?(this.firstEnter=!1,this.scheduleOnce((function(){t.playHitAnimation(),t.node.x=t.node.x-50,t.enterCombat(t.targetMonster)}),.1)):this.enterCombat(this.targetMonster)):this.isMoving||this.playMoveAnimation()}}},s.onMoveButtonClick=function(){if(this.isAttacking||this.isTakingHit||this.isInCombat||!this.isAlive())this.log("å½“å‰çŠ¶æ€æ— æ³•ç§»åŠ¨");else{var t=cc.find("Canvas");if(t)t.getComponent("GameManager").hideFinger();p.instance.playSound("voc_click",.8),1==this.autoEffNode.active&&this.gameManager.startLevel(1),this.log("ç§»åŠ¨æŒ‰é’®ç‚¹å‡»ï¼Œå¼€å§‹ç§»åŠ¨"),this.startMove()}},s.startMove=function(){var t=this;if(this.isMoving)this.log("å·²ç»åœ¨ç§»åŠ¨ä¸­");else{this.autoEffNode.active=!1,this.isMoving=!0,this.targetPosition=cc.v3(this.node.position.x+this.moveDistance,this.node.position.y,this.node.position.z),this.log("å¼€å§‹ç§»åŠ¨åˆ°ä½ç½®: "+this.targetPosition),this.playMoveAnimation(),this.moveTween&&this.moveTween.stop();var i=this.moveDistance/this.moveSpeed;this.moveTween=cc.tween(this.node).to(i,{position:this.targetPosition}).call((function(){t.log("ç§»åŠ¨å®Œæˆ"),t.finishMove()})).start()}},s.finishMove=function(){this.isMoving=!1,this.moveTween=null,this.playIdleAnimation(),this.log("ç§»åŠ¨ç»“æŸï¼Œå›åˆ°å¾…æœºçŠ¶æ€")},s.stopMove=function(){this.moveTween&&(this.moveTween.stop(),this.moveTween=null),this.isMoving=!1,this.log("ç§»åŠ¨è¢«ä¸­æ–­")},s.findMonster=function(){if(this.gameManager){var t=this.gameManager.getMonsters();if(0===t.length)return this.targetMonster=null,void this.log("æ²¡æœ‰æ€ªç‰©");for(var i=this.node.getPosition(),e=t[0],n=cc.Vec2.distance(i,e.getPosition()),o=1;o<t.length;o++){var a=cc.Vec2.distance(i,t[o].getPosition());a<n&&(n=a,e=t[o])}this.targetMonster=e,this.log("æ‰¾åˆ°æœ€è¿‘æ€ªç‰©:",this.targetMonster.name)}else this.log("GameManageræœªæ‰¾åˆ°")},s.playMoveAnimation=function(){this.log("æ’­æ”¾ç§»åŠ¨åŠ¨ç”»"),this.isMoving=!0;var t=this.getParallaxTest();t&&t.setIsScrolling(!0),this.tryPlayAnimation(this.moveAnimationName,!0)||this.log("ç§»åŠ¨åŠ¨ç”»æ’­æ”¾å¤±è´¥ï¼Œä½¿ç”¨å¾…æœºåŠ¨ç”»")},s.playIdleAnimation=function(){this.log("æ’­æ”¾å¾…æœºåŠ¨ç”»"),this.isMoving=!1;var t=this.getParallaxTest();t&&t.setIsScrolling(!1),this.tryPlayAnimation(this.idleAnimationName,!0)||this.log("å¾…æœºåŠ¨ç”»æ’­æ”¾å¤±è´¥")},s.playAttackAnimation=function(){var t=this;this.log("æ’­æ”¾æ”»å‡»åŠ¨ç”»"),this.isMoving=!1;var i=this.getParallaxTest();i&&i.setIsScrolling(!1);var e=this.attackAnimationNameArr[Math.floor(Math.random()*this.attackAnimationNameArr.length)];if(this.currentAttackAnimation=e,"atk"==e?(p.instance.playSound("atk_1"),this.attackInterval=.2):"atk2"==e?(p.instance.playSound("atk_2"),this.attackInterval=.7):("atk3e"==e||"atk3g"==e||"ult"==e)&&(p.instance.playSound("atk_2"),this.attackInterval=.5),this.tryPlayAnimation(e))this.log("æ”»å‡»åŠ¨ç”»æ’­æ”¾æˆåŠŸ"),this.spine.setCompleteListener&&this.spine.setCompleteListener(this.onSpineAnimationComplete.bind(this));else{this.log("æ”»å‡»åŠ¨ç”»æ’­æ”¾å¤±è´¥ï¼Œä½¿ç”¨å®šæ—¶å™¨");for(var n=!1,o=0,a=["idle","Idle","atk","Atk","hurt","Hurt"];o<a.length;o++){var s=a[o];if(this.tryPlayAnimation(s)){n=!0,this.spine.setCompleteListener&&this.spine.setCompleteListener(this.onSpineAnimationComplete.bind(this));break}}n||(this.safeSpineCall("setAnimation",0,this.idleAnimationName,!0),this.scheduleOnce((function(){return t.onAttackFinished()}),1.5))}},s.playHitAnimation=function(){var t=this;if(this.log("æ’­æ”¾å—å‡»åŠ¨ç”»"),this.isMoving=!1,this.tryPlayAnimation(this.hurtAnimationName,!1))this.spine.setCompleteListener&&this.spine.setCompleteListener(this.onSpineAnimationComplete.bind(this));else{for(var i=!1,e=0,n=["hurt","Hurt","hit","Hit"];e<n.length;e++){var o=n[e];if(this.tryPlayAnimation(o,!1)){i=!0,this.spine.setCompleteListener&&this.spine.setCompleteListener(this.onSpineAnimationComplete.bind(this));break}}i||this.scheduleOnce((function(){return t.onHitFinished()}),.2)}},s.playDeathAnimation=function(){this.log("æ’­æ”¾æ­»äº¡åŠ¨ç”»"),this.isMoving=!1,this.tryPlayAnimation(this.deathAnimationName)||(this.log("æ­»äº¡åŠ¨ç”»æ’­æ”¾å¤±è´¥ï¼Œä½¿ç”¨å¾…æœºåŠ¨ç”»"),this.safeSpineCall("setAnimation",0,this.idleAnimationName,!0))},s.tryPlayAnimation=function(t,i){if(!this.hasSpine())return!1;try{if(this.spine.findAnimation)if(!this.spine.findAnimation(t))return this.log("åŠ¨ç”» "+t+" ä¸å­˜åœ¨"),!1;return i=null!==i&&i,this.safeSpineCall("setAnimation",0,t,i)}catch(i){return this.log("å°è¯•æ’­æ”¾åŠ¨ç”» "+t+" æ—¶å‡ºé”™: "+i),!1}},s.onSpineAnimationComplete=function(t){if(t&&t.animation){var i=t.animation.name;this.log("Spine åŠ¨ç”»å®Œæˆ: "+i),this.attackAnimationNameArr.includes(i)||"atk"===i||"atk2"===i||"atk3f"===i||"atk3g"===i||"ult"===i?(this.isAttacking=!1,this.isMultiHitActive&&this.stopMultiHitAttack(),this.onAttackFinished()):i!==this.hurtAnimationName&&"hurt"!==i&&"Hurt"!==i||this.onHitFinished()}},s.enterCombat=function(t){!this.isTakingHit&&this.isAlive()?(this.stopMove(),this.isInCombat=!0,this.isMoving=!1,this.isAttacking=!0,this.targetMonster=t,this.log("è¿›å…¥æˆ˜æ–—çŠ¶æ€"),this.playIdleAnimation(),this.executeAttack()):this.log("æ— æ³•è¿›å…¥æˆ˜æ–—ï¼Œæ¡ä»¶ä¸æ»¡è¶³")},s.exitCombat=function(){this.isInCombat=!1,this.isMultiHitActive&&this.stopMultiHitAttack(),this.log("é€€å‡ºæˆ˜æ–—çŠ¶æ€"),this.hasSpine()&&this.spine.setCompleteListener&&this.spine.setCompleteListener(null),this.isAlive()&&!this.isTakingHit&&this.playIdleAnimation()},s.canAttack=function(){return Date.now()-this.lastAttackTime>=1e3*this.attackInterval},s.executeAttack=function(){this.canAttack()&&this.isInCombat&&this.targetMonster&&this.targetMonster.isValid&&(this.log("æ‰§è¡Œæ”»å‡»"),this.lastAttackTime=Date.now(),this.playAttackAnimation(),this.isSpecialSkillAnimation(this.currentAttackAnimation)&&this.enableMultiHit?this.startMultiHitAttack():this.doAoeDamage(!1))},s.doAoeDamage=function(t){var i=this;if(void 0===t&&(t=!1),this.gameManager){var e=this.gameManager.getMonsters();if(0!==e.length){var n=this.node.getPosition(),o=0;e.forEach((function(e){if(e.isValid&&cc.Vec2.distance(n,e.getPosition())<=i.aoeRange){var a=i.calculateDamage(t),s=e.getComponent("Monster");s&&"function"==typeof s.takeDamage&&(s.takeDamage(a.damage,a.isCrit),o++,i.log("å¯¹æ€ªç‰© "+e.name+" é€ æˆ "+a.damage+" ä¼¤å®³"+(a.isCrit?" (æš´å‡»!)":"")))}})),o>0&&this.log("AOEæ”»å‡»å‘½ä¸­ "+o+" ä¸ªæ€ªç‰©")}}},s.calculateDamage=function(t){void 0===t&&(t=!1);var i=t||Math.random()<this.critRate,e=this.attackDamage;return i&&(e=Math.floor(e*this.critMultiplier)),{damage:e,isCrit:i}},s.startMultiHitAttack=function(){var t=this;this.isMultiHitActive=!0,this.currentHitCount=0,this.multiHitTimer&&clearInterval(this.multiHitTimer),this.doMultiHitDamage(),this.multiHitTimer=setInterval((function(){t.doMultiHitDamage()}),1e3*this.multiHitInterval)},s.doMultiHitDamage=function(){if(this.currentHitCount>=this.multiHitCount||!this.isMultiHitActive)this.stopMultiHitAttack();else{var t=1-this.currentHitCount*this.multiHitDamageReduction,i=Math.floor(this.attackDamage*Math.max(t,.2)),e=this.attackDamage;this.attackDamage=i;var n=this.currentHitCount===this.multiHitCount-1;this.doAoeDamage(n),this.attackDamage=e,this.currentHitCount++,this.log("å¤šæ®µæ”»å‡»ç¬¬ "+this.currentHitCount+" æ®µï¼Œä¼¤å®³: "+i)}},s.stopMultiHitAttack=function(){this.multiHitTimer&&(clearInterval(this.multiHitTimer),this.multiHitTimer=null),this.isMultiHitActive=!1,this.currentHitCount=0,this.log("å¤šæ®µæ”»å‡»ç»“æŸ")},s.isSpecialSkillAnimation=function(t){return["ult","atk2","atk3g"].some((function(i){return t.toLowerCase().includes(i.toLowerCase())}))},s.onAttackFinished=function(){this.log("æ”»å‡»åŠ¨ç”»å®Œæˆ")},s.takeDamage=function(t){if(this.isAlive()){this.currentHealth-=t,this.log("å—åˆ° "+t+" ä¼¤å®³ï¼Œå‰©ä½™ç”Ÿå‘½: "+this.currentHealth),this.stopMove(),this.isTakingHit=!0,this.doDamageNum++;var i=cc.find("Canvas"),e=i.getComponent("GameManager");if(i&&e&&"function"==typeof e.getCurrentLevel)4==e.getCurrentLevel()?this.isTakingHit=!1:(this.exitCombat(),this.playHitAnimation(),this.doDamageNum>=2&&(this.isTakingHit=!1,this.doDamageNum=0,this.onHitFinished()));var n=this.healthBarNode.getComponent(h);if(this.healthBarNode){var o=this.currentHealth/this.maxHealth;n&&(n.progress=o)}else this.healthBarNode.destroy();this.currentHealth<=0&&this.die()}},s.onHitFinished=function(){this.log("å—å‡»å®Œæˆ"),this.isTakingHit=!1,this.isMultiHitActive&&this.stopMultiHitAttack(),this.isAlive()&&(this.targetMonster&&this.targetMonster.isValid?this.enterCombat(this.targetMonster):this.playIdleAnimation())},s.die=function(){var t=this;this.log("ç©å®¶æ­»äº¡"),this.exitCombat(),this.isMoving=!1,this.isMultiHitActive&&this.stopMultiHitAttack(),this.stopMove(),this.playDeathAnimation(),this.boxCollider&&(this.boxCollider.enabled=!1),this.moveButton&&(this.moveButton.active=!1),this.scheduleOnce((function(){t.log("æ¸¸æˆç»“æŸ");try{var i=cc.find("Canvas");if(i){var e=i.getComponent("GameManager");e&&"function"==typeof e.onPlayerDied&&e.onPlayerDied(t.node)}}catch(i){t.log("é€šçŸ¥ GameManager å¤±è´¥: "+i)}}),1)},s.onBeginContact=function(t,i){if(this.log("ç¢°æ’å¼€å§‹: "+i.node.name),"monster"===i.node.group||i.node.name.includes("Monster")){var e=i.node;e.getComponent("Monster")&&this.isAlive()&&(this.log("ä¸æ€ªç‰©ç¢°æ’ï¼Œè¿›å…¥æˆ˜æ–—"),this.enterCombat(e))}},s.onEndContact=function(t,i){this.log("ç¢°æ’ç»“æŸ: "+i.node.name),("monster"===i.node.group||i.node.name.includes("Monster"))&&(this.log("ä¸æ€ªç‰©åˆ†ç¦»ï¼Œé€€å‡ºæˆ˜æ–—"),this.exitCombat())},s.hasSpine=function(){return this.spineAvailable&&this.spineComponent&&this.spineComponent.isValid},s.safeSpineCall=function(t){if(!this.hasSpine())return!1;try{if(this.spine[t]&&"function"==typeof this.spine[t]){for(var i,e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];return(i=this.spine)[t].apply(i,n),!0}}catch(i){this.log("è°ƒç”¨ Spine æ–¹æ³• "+t+" å¤±è´¥: "+i)}return!1},s.isAlive=function(){return this.currentHealth>0},s.log=function(t,i){void 0===i&&(i=!0),(this.debugMode||i)&&console.log("[Player] "+t)},s.onLevelUp=function(t){console.log("ç©å®¶å‡çº§åˆ° "+t+" çº§ï¼Œå±æ€§æå‡!"),this._attackPower+=5,this._maxHealth+=20,this._currentHealth=this._maxHealth,this.attackDamage+=this._attackPower,this.playLevelUpEffect(),this.updatePlayerUI()},s.playLevelUpEffect=function(){console.log("âœ¨ æ’­æ”¾å‡çº§ç‰¹æ•ˆ!"),p.instance.playSound("voc_lvup",.8),this.levelUpSpine?(this.levelUpSpine.active=!0,this.levelUpSpine.getComponent("sp.Skeleton").setAnimation(0,"action",!1)):console.warn("æœªæ‰¾åˆ°é¢„åˆ›å»ºçš„å‡çº§æ–‡æœ¬èŠ‚ç‚¹")},s.setEquipData=function(t){this.attackDamage+=t.attack},s.updatePlayerUI=function(){},s.getAttackPower=function(){return this._attackPower},s.stopAttack=function(){console.log("ç©å®¶åœæ­¢æ”»å‡»"),this.isAttacking=!1,this.targetMonster=null,this.playIdleAnimation()},s.onDestroy=function(){this.multiHitTimer&&clearInterval(this.multiHitTimer),this.hasSpine()&&this.spine.setCompleteListener&&this.spine.setCompleteListener(null),this.unscheduleAllCallbacks(),this.moveTween&&this.moveTween.stop(),this.boxCollider&&(this.boxCollider.off(r.BEGIN_CONTACT,this.onBeginContact,this),this.boxCollider.off(r.END_CONTACT,this.onEndContact,this)),this.moveButton&&this.moveButton.off(cc.Node.EventType.TOUCH_START,this.onMoveButtonClick,this)},e(n,[{key:"spine",get:function(){return this.spineComponent}}]),n}(cc.Component),G=n(V.prototype,"spineComponent",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=n(V.prototype,"spineNode",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=n(V.prototype,"boxCollider",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=n(V.prototype,"moveSpeed",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 100}}),K=n(V.prototype,"maxHealth",[Ct],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1e4}}),Q=n(V.prototype,"health",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1e4}}),W=n(V.prototype,"attackDamage",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 15}}),X=n(V.prototype,"colliderSize",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return cc.size(80,120)}}),Y=n(V.prototype,"colliderOffset",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return cc.v2(0,0)}}),Z=n(V.prototype,"attackRange",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 200}}),$=n(V.prototype,"attackInterval",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.8}}),tt=n(V.prototype,"moveAnimationName",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"Move"}}),it=n(V.prototype,"idleAnimationName",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"Idle"}}),et=n(V.prototype,"attackAnimationName",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),nt=n(V.prototype,"hurtAnimationName",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"Hurt"}}),ot=n(V.prototype,"deathAnimationName",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"Death"}}),at=n(V.prototype,"moveButton",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),st=n(V.prototype,"autoEffNode",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),lt=n(V.prototype,"moveDistance",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 200}}),rt=n(V.prototype,"levelUpSpine",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ht=n(V.prototype,"aoeRange",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 170}}),ct=n(V.prototype,"critRate",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.4}}),ut=n(V.prototype,"critMultiplier",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1.5}}),pt=n(V.prototype,"enableMultiHit",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),mt=n(V.prototype,"multiHitCount",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 3}}),gt=n(V.prototype,"multiHitInterval",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.2}}),ft=n(V.prototype,"multiHitDamageReduction",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.2}}),dt=n(V.prototype,"healthBarNode",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),vt=n(V.prototype,"debugMode",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),U=V))||U));s._RF.pop()}}}));

System.register("chunks:///_virtual/popRewardWin.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AudioManager.ts"],(function(e){var n,t,o,i,a;return{setters:[function(e){n=e.inheritsLoose},function(e){t=e.cclegacy,o=e._decorator,i=e.Component},function(e){a=e.AudioManager}],execute:function(){var c,s;t._RF.push({},"f950eowtLJDl5O1rb+0lQqb","popRewardWin",void 0);var d=o.ccclass;o.property,e("popRewardWin",d("popRewardWin")(((s=function(e){function t(){return e.apply(this,arguments)||this}n(t,e);var o=t.prototype;return o.onLoad=function(){var e=this,n=this.node.getChildByName("Layout");n&&n.isValid&&n.on(cc.Node.EventType.TOUCH_END,(function(){a.instance.playSound("voc_click",.8),e.closeDetailPopup()}),this),null===t.instance?t.instance=this:this.destroy()},o.start=function(){},o.update=function(e){},o.initInfo=function(e){1==e?(this.node.getChildByName("good3").active=!0,this.node.getChildByName("good4").active=!1):(this.node.getChildByName("good3").active=!1,this.node.getChildByName("good4").active=!0)},o.closeDetailPopup=function(){if(this.node&&cc.isValid(this.node)){this.node.active=!1,console.log("å¼¹çª—å·²éšè—");var e=cc.find("Canvas");if(e)e.getComponent("GameManager").hideFinger()}},t}(i)).instance=null,c=s))||c);t._RF.pop()}}}));

System.register("chunks:///_virtual/ProgressTrigger.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(r){var e,t,n,i,o,s,g;return{setters:[function(r){e=r.applyDecoratedDescriptor,t=r.inheritsLoose,n=r.initializerDefineProperty,i=r.assertThisInitialized},function(r){o=r.cclegacy,s=r._decorator,g=r.Component}],execute:function(){var a,c,l;o._RF.push({},"48814qNrYVFqI61+aI1maV8","ProgressTrigger",void 0);var u=s.ccclass,p=s.property;r("ProgressTrigger",u("ProgressTrigger")((l=e((c=function(r){function e(){for(var e,t=arguments.length,o=new Array(t),s=0;s<t;s++)o[s]=arguments[s];return e=r.call.apply(r,[this].concat(o))||this,n(e,"triggerProgress",l,i(e)),e.hasTriggered=!1,e}t(e,r);var o=e.prototype;return o.update=function(r){},o.triggerEvent=function(){console.log("Progress reached "+this.triggerProgress+", triggering event!");var r=find("canvas/Player").getComponent("PlayerController");r&&r.resumeRunning()},e}(g)).prototype,"triggerProgress",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),a=c))||a);o._RF.pop()}}}));

System.register("chunks:///_virtual/SafeAnimationHelper.ts",["cc"],(function(c){var o;return{setters:[function(c){o=c.cclegacy}],execute:function(){o._RF.push({},"7590bAI8GFJ6LTlHOSGcNjO","SafeAnimationHelper",void 0);var e=cc._decorator;e.ccclass,e.property,c("SafeAnimationHelper",function(){function c(){}return c.moveTo=function(c,o,e,n){return c&&c.isValid?o?void(void 0!==cc.tween?cc.tween(c).to(e,{position:o}).call((function(){n&&n()})).start():(console.warn("Tween ç³»ç»Ÿä¸å¯ç”¨ï¼Œç›´æ¥è®¾ç½®ä½ç½®"),c.position=o,n&&n())):(console.warn("ç›®æ ‡ä½ç½®æ— æ•ˆï¼Œæ— æ³•æ‰§è¡Œç§»åŠ¨åŠ¨ç”»"),void(n&&n())):(console.warn("èŠ‚ç‚¹æ— æ•ˆï¼Œæ— æ³•æ‰§è¡Œç§»åŠ¨åŠ¨ç”»"),void(n&&n()))},c.scaleTo=function(c,o,e,n){if(!c||!c.isValid)return console.warn("èŠ‚ç‚¹æ— æ•ˆï¼Œæ— æ³•æ‰§è¡Œç¼©æ”¾åŠ¨ç”»"),void(n&&n());void 0!==cc.tween?cc.tween(c).to(e,{scale:new cc.Vec3(o,o,1)}).call((function(){n&&n()})).start():(console.warn("Tween ç³»ç»Ÿä¸å¯ç”¨ï¼Œç›´æ¥è®¾ç½®ç¼©æ”¾"),c.scale=o,n&&n())},c.moveAndScale=function(c,o,e,n,t){return c&&c.isValid?o?void(void 0!==cc.tween?cc.tween(c).to(n,{position:o,scale:new cc.Vec3(e,e,1)}).call((function(){t&&t()})).start():(console.warn("Tween ç³»ç»Ÿä¸å¯ç”¨ï¼Œç›´æ¥è®¾ç½®ä½ç½®å’Œç¼©æ”¾"),c.position=o,c.scale=e,t&&t())):(console.warn("ç›®æ ‡ä½ç½®æ— æ•ˆï¼Œæ— æ³•æ‰§è¡Œç§»åŠ¨å’Œç¼©æ”¾åŠ¨ç”»"),void(t&&t())):(console.warn("èŠ‚ç‚¹æ— æ•ˆï¼Œæ— æ³•æ‰§è¡Œç§»åŠ¨å’Œç¼©æ”¾åŠ¨ç”»"),void(t&&t()))},c.createColorFlash=function(c,o,e,n){if(void 0===e&&(e=.3),!c||!c.isValid)return console.warn("èŠ‚ç‚¹æ— æ•ˆï¼Œæ— æ³•æ‰§è¡Œé¢œè‰²é—ªçƒåŠ¨ç”»"),void(n&&n());c.color||(c.color=cc.Color.WHITE);var t=c.color?c.color.clone():cc.Color.WHITE;void 0!==cc.tween?cc.tween(c).to(e/2,{color:o}).to(e/2,{color:t}).call((function(){n&&n()})).start():(console.warn("Tween ç³»ç»Ÿä¸å¯ç”¨ï¼Œç›´æ¥è®¾ç½®æœ€ç»ˆé¢œè‰²"),c.color=t,n&&n())},c.createPressEffect=function(c,o){if(!c||!c.isValid)return console.warn("èŠ‚ç‚¹æ— æ•ˆï¼Œæ— æ³•æ‰§è¡ŒæŒ‰å‹æ•ˆæœåŠ¨ç”»"),void(o&&o());void 0!==cc.tween?cc.tween(c).to(.1,{scale:new cc.Vec3(.8,.8,1)}).to(.1,{scale:new cc.Vec3(1.1,1.1,1)}).to(.1,{scale:new cc.Vec3(1,1,1)}).call((function(){o&&o()})).start():(console.warn("Tween ç³»ç»Ÿä¸å¯ç”¨ï¼Œç›´æ¥è®¾ç½®æœ€ç»ˆçŠ¶æ€"),c.scale=1,o&&o())},c}());o._RF.pop()}}}));

System.register("chunks:///_virtual/SimpleFingerAnimation.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(i){var t,e,n,o,a,r,s,l,c,u,p;return{setters:[function(i){t=i.applyDecoratedDescriptor,e=i.inheritsLoose,n=i.initializerDefineProperty,o=i.assertThisInitialized},function(i){a=i.cclegacy,r=i._decorator,s=i.Sprite,l=i.Vec3,c=i.UIOpacity,u=i.tween,p=i.Component}],execute:function(){var h,g,y,f,d,m,P,b,v,D,w;a._RF.push({},"254d62PiMZKyIMed2HXCoQp","SimpleFingerAnimation",void 0);var S=r.ccclass,z=r.property;i("SimpleFingerAnimation",(h=S("SimpleFingerAnimation"),g=z(s),h((d=t((f=function(i){function t(){for(var t,e=arguments.length,a=new Array(e),r=0;r<e;r++)a[r]=arguments[r];return t=i.call.apply(i,[this].concat(a))||this,n(t,"fingerSprite",d,o(t)),n(t,"moveDistance",m,o(t)),n(t,"moveDuration",P,o(t)),n(t,"clickScale",b,o(t)),n(t,"stayDuration",v,o(t)),n(t,"fadeDuration",D,o(t)),n(t,"loopDelay",w,o(t)),t.originalPos=new l,t.targetPos=new l,t.isPlaying=!1,t}e(t,i);var a=t.prototype;return a.onLoad=function(){this.originalPos.set(this.node.position),this.targetPos.set(this.originalPos.x,this.originalPos.y-this.moveDistance,this.originalPos.z)},a.start=function(){this.play()},a.play=function(){var i=this;if(!this.isPlaying){this.isPlaying=!0,this.node.active=!0,this.node.setPosition(this.originalPos),this.node.setScale(l.ONE);var t=this.node.getComponent(c)||this.node.addComponent(c);t.opacity=255,u(this.node).to(this.moveDuration,{position:this.targetPos}).call((function(){u(i.node).to(.1,{scale:new l(i.clickScale,i.clickScale,1)}).to(.1,{scale:l.ONE}).start()})).delay(this.stayDuration).call((function(){u(t).to(i.fadeDuration,{opacity:0}).start()})).to(this.moveDuration,{position:this.originalPos}).call((function(){i.isPlaying=!1,i.scheduleOnce((function(){i.play()}),i.loopDelay)})).start()}},a.stop=function(){this.node.stopAllActions(),this.isPlaying=!1},a.setAnimationPath=function(i,t){this.originalPos.set(i),this.targetPos.set(t),this.isPlaying&&(this.hide(),this.play())},a.showAtPosition=function(i,t){this.node.active=!0,t?this.setAnimationPath(i,t):(this.originalPos.set(i),this.targetPos.set(i.x,i.y-this.moveDistance,i.z)),this.play()},a.hide=function(){this.isPlaying=!1,this.node.active=!1},a.show=function(){this.node.active=!0,this.node.setPosition(this.originalPos);var i=this.node.getComponent(c);i&&(i.opacity=255)},t}(p)).prototype,"fingerSprite",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m=t(f.prototype,"moveDistance",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 20}}),P=t(f.prototype,"moveDuration",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.3}}),b=t(f.prototype,"clickScale",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.9}}),v=t(f.prototype,"stayDuration",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.3}}),D=t(f.prototype,"fadeDuration",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.3}}),w=t(f.prototype,"loopDelay",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),y=f))||y));a._RF.pop()}}}));

System.register("chunks:///_virtual/SimpleParallaxTest.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,i,r,n,o,l,s,a,c,u;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,r=t.initializerDefineProperty,n=t.assertThisInitialized},function(t){o=t.cclegacy,l=t._decorator,s=t.Node,a=t.LabelComponent,c=t.Button,u=t.Component}],execute:function(){var g,h,p,f,b,y,d,S,L,P,v,m,k;o._RF.push({},"630db3xh/JBE5SGKzrCLZQn","SimpleParallaxTest",void 0);var z=l.ccclass,B=l.property;t("SimpleParallaxTest",(g=z("SimpleParallaxTest"),h=B([s]),p=B(a),f=B(c),b=B(c),g((S=e((d=function(t){function e(){for(var e,i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];return e=t.call.apply(t,[this].concat(o))||this,r(e,"backgroundLayers",S,n(e)),r(e,"layerSpeeds",L,n(e)),r(e,"globalScrollSpeed",P,n(e)),r(e,"infoLabel",v,n(e)),r(e,"toggleButton",m,n(e)),r(e,"resetButton",k,n(e)),e.isScrolling=!0,e.currentProgress=0,e.initialPositions=[],e}i(e,t);var o=e.prototype;return o.onLoad=function(){console.log("ç®€å•è§†å·®èƒŒæ™¯æµ‹è¯•å¼€å§‹");for(var t=0;t<this.backgroundLayers.length;t++)this.backgroundLayers[t]&&(this.initialPositions[t]=this.backgroundLayers[t].position.x,console.log("å›¾å±‚"+t+"åˆå§‹ä½ç½®: "+this.initialPositions[t]));this.toggleButton,this.resetButton&&this.resetButton.node.on("click",this.resetScrolling,this)},o.start=function(){this.schedule(this.updateUI,.1)},o.update=function(t){this.isScrolling&&(this.currentProgress+=t,this.updateAllLayers())},o.getIsScrolling=function(){return this.isScrolling},o.setIsScrolling=function(t){this.isScrolling=t,console.log("è®¾ç½®æ»šåŠ¨çŠ¶æ€ä¸º:",this.isScrolling)},o.updateAllLayers=function(){for(var t=0;t<this.backgroundLayers.length;t++)this.updateLayer(t)},o.updateLayer=function(t){var e=this.backgroundLayers[t];if(e){var i=this.layerSpeeds[t]||1,r=(this.initialPositions[t]||0)-this.currentProgress*this.globalScrollSpeed*i%3e3,n=e.position;e.setPosition(r,n.y,n.z)}},o.updateUI=function(){if(this.infoLabel){for(var t=this.isScrolling?"æ»šåŠ¨ä¸­":"å·²åœæ­¢",e="",i=0;i<this.layerSpeeds.length;i++)e+="å›¾å±‚"+i+":"+this.layerSpeeds[i]+" ";this.infoLabel.string="è¿›åº¦: "+this.currentProgress.toFixed(1)+"ç§’\nçŠ¶æ€: "+t+"\n"+e}},o.toggleScrolling=function(){this.setIsScrolling(!this.isScrolling),console.log("åˆ‡æ¢æ»šåŠ¨çŠ¶æ€:",this.isScrolling)},o.resetScrolling=function(){this.currentProgress=0,console.log("é‡ç½®æ»šåŠ¨è¿›åº¦");for(var t=0;t<this.backgroundLayers.length;t++)this.resetLayer(t)},o.resetLayer=function(t){var e=this.backgroundLayers[t];if(e){var i=this.initialPositions[t]||0,r=e.position;e.setPosition(i,r.y,r.z)}},e}(u)).prototype,"backgroundLayers",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),L=e(d.prototype,"layerSpeeds",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[.3,.6,.8,1]}}),P=e(d.prototype,"globalScrollSpeed",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 50}}),v=e(d.prototype,"infoLabel",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m=e(d.prototype,"toggleButton",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=e(d.prototype,"resetButton",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=d))||y));o._RF.pop()}}}));

System.register("chunks:///_virtual/SlotsMachine.ts",["./rollupPluginModLoBabelHelpers.js","cc","./popRewardWin.ts","./AudioManager.ts"],(function(e){var t,i,n,s,r,o,c;return{setters:[function(e){t=e.inheritsLoose,i=e.applyDecoratedDescriptor,n=e.initializerDefineProperty,s=e.assertThisInitialized},function(e){r=e.cclegacy},function(e){o=e.popRewardWin},function(e){c=e.AudioManager}],execute:function(){var l,a,h,u,p,f,d,g,S,R,v,m,b,w,y;r._RF.push({},"c533esLQf9Ov7XmbYE9URi/","SlotsMachine",void 0);var C=cc._decorator,P=C.ccclass,A=C.property;e("default",(l=A([cc.Node]),a=A(cc.Button),h=A([cc.SpriteFrame]),u=A([cc.Float]),p=A(cc.Label),P((d=function(e){function i(){for(var t,i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return t=e.call.apply(e,[this].concat(r))||this,n(t,"reelParentNodes",g,s(t)),n(t,"btnAction",S,s(t)),n(t,"rewardSprites",R,s(t)),n(t,"rollSpeed",v,s(t)),n(t,"reelSpeeds",m,s(t)),n(t,"btnLabel",b,s(t)),n(t,"iconHeight",w,s(t)),n(t,"visibleIcons",y,s(t)),t.reelContainers=[],t.isRolling=[!1,!1,!1],t.finalResults=[-1,-1,-1],t.isInitialized=!1,t.currentReelPositions=[0,0,0],t.isStopping=[!1,!1,!1],t.isProcessingAction=!1,t.guanqiaNum=1,t}t(i,e);var r=i.prototype;return r.onLoad=function(){this.initializeGame()},r.start=function(){var e=this;this.scheduleOnce((function(){e.finalizeInitialization()}),.1)},r.initializeGame=function(){this.checkRequiredComponents()?(this.setupReelStructure(),this.createReelContainers(),this.resetGameState(),this.bindButtonEvents(),cc.log("è€è™æœºæ¸¸æˆåˆå§‹åŒ–å®Œæˆ")):cc.error("æ¸¸æˆåˆå§‹åŒ–å¤±è´¥ï¼šç¼ºå°‘å¿…è¦ç»„ä»¶")},r.setupReelStructure=function(){for(var e=0;e<this.reelParentNodes.length;e++){var t=this.reelParentNodes[e],i=t.getComponent(cc.Mask);i||(i=t.addComponent(cc.Mask)),i.type=cc.Mask.Type.RECT,i.alphaThreshold=.1,t.getComponent("cc.UITransform").setContentSize(cc.size(100,this.iconHeight)),t.setScale(1,1);var n=new cc.Node("ContainerParent");n.parent=t,n.setPosition(0,0),n.setScale(1,1),this.reelContainers[e]=n}},r.createReelContainers=function(){if(this.rewardSprites&&0!==this.rewardSprites.length)for(var e=0;e<this.reelContainers.length;e++){var t=this.reelContainers[e];if(t&&cc.isValid(t)){t.removeAllChildren(),t.setScale(1,1);for(var i=this.visibleIcons+2,n=0;n<i;n++){var s=new cc.Node("Icon"),r=s.addComponent(cc.Sprite),o=n%this.rewardSprites.length;this.rewardSprites[o]&&(r.spriteFrame=this.rewardSprites[o]),s.parent=t,s.y=(n-1)*this.iconHeight,s.getComponent("cc.UITransform").setContentSize(cc.size(80,80)),s.setScale(1,1),s.getComponent("cc.UITransform").setAnchorPoint(.5,.5)}}else cc.error("å®¹å™¨çˆ¶èŠ‚ç‚¹ "+e+" æ— æ•ˆ")}else cc.error("rewardSprites æ•°ç»„ä¸ºç©ºæˆ–æœªå®šä¹‰")},r.checkRequiredComponents=function(){if(!this.btnAction)return cc.error("æ“ä½œæŒ‰é’®æœªç»‘å®š"),!1;if(!this.reelParentNodes||3!==this.reelParentNodes.length)return cc.error("éœ€è¦ exactly 3 ä¸ªè½¬å­çˆ¶èŠ‚ç‚¹"),!1;for(var e=0;e<this.reelParentNodes.length;e++)if(!this.reelParentNodes[e]||!cc.isValid(this.reelParentNodes[e]))return cc.error("è½¬å­çˆ¶èŠ‚ç‚¹ "+e+" æœªç»‘å®šæˆ–æ— æ•ˆ"),!1;return!(!this.rewardSprites||0===this.rewardSprites.length)||(cc.error("å¥–åŠ±å›¾æ ‡æ•°ç»„ä¸ºç©ºæˆ–æœªå®šä¹‰"),!1)},r.finalizeInitialization=function(){this.isInitialized=!0,this.updateButtonState(),cc.log("æ¸¸æˆå‡†å¤‡å°±ç»ª")},r.resetGameState=function(){this.isRolling=[!1,!1,!1],this.isStopping=[!1,!1,!1],this.isProcessingAction=!1,this.finalResults=[-1,-1,-1],this.currentReelPositions=[0,0,0];for(var e=0;e<this.reelContainers.length;e++)this.reelContainers[e]&&cc.isValid(this.reelContainers[e])&&(this.reelContainers[e].y=0)},r.bindButtonEvents=function(){this.btnAction.node.off("click",this.onActionButtonClick,this),this.btnAction.node.on("click",this.onActionButtonClick,this),cc.log("æŒ‰é’®äº‹ä»¶ç»‘å®šå®Œæˆ")},r.onActionButtonClick=function(){if(this.isProcessingAction)cc.log("æ“ä½œæ­£åœ¨è¿›è¡Œä¸­ï¼Œè¯·ç­‰å¾…");else if(c.instance.playSound("voc_click",.8),this.isInitialized){this.isProcessingAction=!0;try{this.isRolling.some((function(e){return e}))?this.stopRolling():this.startRolling()}catch(e){cc.error("æŒ‰é’®ç‚¹å‡»å¤„ç†å‡ºé”™:",e),this.isProcessingAction=!1}}else cc.warn("æ¸¸æˆæœªåˆå§‹åŒ–å®Œæˆ")},r.startRolling=function(){cc.log("å¼€å§‹æ»šåŠ¨!"),this.finalResults||(this.finalResults=[-1,-1,-1]),this.isRolling||(this.isRolling=[!1,!1,!1]),this.isStopping||(this.isStopping=[!1,!1,!1]),this.currentReelPositions||(this.currentReelPositions=[0,0,0]),this.finalResults=[-1,-1,-1],this.isStopping=[!1,!1,!1];for(var e=0;e<this.reelParentNodes.length;e++)this.isRolling[e]=!0,this.currentReelPositions[e]=0;this.updateButtonState(),this.isProcessingAction=!1},r.stopRolling=function(){var e=this;cc.log("åœæ­¢æ»šåŠ¨!"),this.btnAction.interactable=!1,this.generateRandomResults(),this.scheduleOnce((function(){return e.stopSingleReel(0)}),.5),this.scheduleOnce((function(){return e.stopSingleReel(1)}),1),this.scheduleOnce((function(){return e.stopSingleReel(2)}),1.5),this.isProcessingAction=!1},r.generateRandomResults=function(){for(var e=0;e<this.reelParentNodes.length;e++){this.finalResults[e]=Math.floor(Math.random()*this.rewardSprites.length);var t=cc.find("Canvas");if(t){var i=t.getComponent("GameManager");if(i&&"function"==typeof i.getCurrentLevel)3==i.getCurrentLevel()?(this.finalResults[e]=4,this.guanqiaNum=3):(this.guanqiaNum=1,this.finalResults[e]=3)}}cc.log("ç”Ÿæˆçš„ç»“æœ: ["+this.finalResults.join(", ")+"]")},r.stopSingleReel=function(e){var t=this;if(e<0||e>=this.reelParentNodes.length)cc.error("æ— æ•ˆçš„è½¬å­ç´¢å¼•: "+e);else{this.isRolling[e]=!1,this.isStopping[e]=!0;var i=-this.finalResults[e]*this.iconHeight,n=this.reelContainers[e];this.forceUpdateReelIcons(e);try{cc.tween(n).to(1,{y:i},{easing:"backOut",onUpdate:function(i,n){i&&cc.isValid(i)&&(i.setScale(1,1),t.updateReelIcons(e))}}).call((function(){n&&cc.isValid(n)&&(cc.log("è½¬å­ "+e+" åœæ­¢ï¼Œæ˜¾ç¤º: "+t.finalResults[e]),t.fixReelDisplay(e),t.isStopping[e]=!1,t.isAllReelsStopped()&&t.onAllReelsStopped())})).start()}catch(t){cc.error("è½¬å­ "+e+" åœæ­¢åŠ¨ç”»å‡ºé”™:",t),this.isStopping[e]=!1,this.fixReelDisplay(e),this.isAllReelsStopped()&&this.onAllReelsStopped()}}},r.forceUpdateReelIcons=function(e){var t=this.reelContainers[e];if(t)for(var i=t.children,n=this.finalResults[e],s=0;s<i.length;s++){var r=i[s],o=r.getComponent(cc.Sprite);if(o){var c=(n+s-1+this.rewardSprites.length)%this.rewardSprites.length;o.spriteFrame=this.rewardSprites[c]}r.getComponent("cc.UITransform").setContentSize(cc.size(80,80)),r.setScale(1,1)}},r.updateReelIcons=function(e){var t=this.reelContainers[e];if(t)for(var i=t.children,n=t.y,s=0;s<i.length;s++){var r=i[s],o=r.y+n;if(r.getComponent("cc.UITransform").setContentSize(cc.size(80,80)),r.setScale(1,1),o>1.5*this.iconHeight){if(r.y-=i.length*this.iconHeight,this.isRolling[e]){var c=r.getComponent(cc.Sprite);if(c){var l=Math.floor(Math.random()*this.rewardSprites.length);c.spriteFrame=this.rewardSprites[l]}}}else if(o<1.5*-this.iconHeight&&(r.y+=i.length*this.iconHeight,this.isRolling[e])){var a=r.getComponent(cc.Sprite);if(a){var h=Math.floor(Math.random()*this.rewardSprites.length);a.spriteFrame=this.rewardSprites[h]}}if(this.isStopping[e]||!this.isRolling[e]){var u=r.getComponent(cc.Sprite);if(u){this.finalResults[e],this.rewardSprites.length,this.rewardSprites.length;u.spriteFrame=this.rewardSprites[1]}}}},r.fixReelDisplay=function(e){var t=this.reelContainers[e];if(t){var i=this.finalResults[e];t.y=-i*this.iconHeight,this.forceUpdateReelIcons(e),cc.log("è½¬å­ "+e+" ä¿®å¤å®Œæˆï¼Œä½ç½®: "+t.y+", ç»“æœ: "+i)}},r.isAllReelsStopped=function(){return this.isRolling.every((function(e){return!e}))&&this.isStopping.every((function(e){return!e}))},r.onAllReelsStopped=function(){cc.log("æ‰€æœ‰è½¬å­å·²åœæ­¢!");for(var e=0;e<this.reelParentNodes.length;e++)this.fixReelDisplay(e);this.checkReward(),this.updateButtonState(),this.showResult()},r.updateButtonState=function(){var e=this.isRolling.some((function(e){return e}));this.btnAction.interactable=!0,this.btnLabel,cc.log("æŒ‰é’®çŠ¶æ€æ›´æ–°: "+(e?"åœæ­¢":"å¼€å§‹"))},r.update=function(e){if(this.isInitialized)for(var t=0;t<this.reelParentNodes.length;t++)if(this.isRolling[t]&&!this.isStopping[t]){var i=this.reelSpeeds[t]||this.rollSpeed,n=this.reelContainers[t];n.y-=i*e,n.setScale(1,1),this.updateReelIcons(t),this.currentReelPositions[t]=n.y}},r.checkReward=function(){var e=this;this.scheduleOnce((function(){var t=e.finalResults,i=t[0],n=t[1],s=t[2];c.instance.playSound("voc_reward_get"),i===n&&n===s?(cc.log("ğŸ‰ å¤§å¥–! ä¸‰ä¸ªå›¾æ¡ˆç›¸åŒ!"),e.onBigWin()):i===n||i===s||n===s?(cc.log("ğŸŠ å°å¥–! ä¸¤ä¸ªå›¾æ¡ˆç›¸åŒ!"),e.onSmallWin()):(cc.log("ğŸ˜¢ æœªä¸­å¥–"),e.onNoWin())}),.5)},r.showResult=function(){var e=this,t=this.finalResults.map((function(t){return e.rewardSprites[t]?e.rewardSprites[t].name:"æœªçŸ¥"})).join(" - ");cc.log("æœ€ç»ˆç»“æœ: "+t)},r.onBigWin=function(){this.node.active=!1,this.node.parent.getChildByName("popRewardWin").active=!0,o.instance&&o.instance.initInfo(this.guanqiaNum);var e=cc.find("Canvas");if(e){var t=e.getComponent("GameManager");t.hideFinger(),t.showFinger(cc.Vec3(0,0,0),cc.Vec3(0,-111,0))}this.node.emit("slot-machine-completed")},r.onSmallWin=function(){for(var e=0;e<this.reelParentNodes.length;e++)if(this.reelParentNodes[e]&&cc.isValid(this.reelParentNodes[e]))this.reelParentNodes[e].color},r.onNoWin=function(){},r.showGetRewardsWin=function(){console.log("æ­å–œè·å¾—")},r.playFoldAnimation=function(e,t){for(var i=this,n=0;n<this.reelParentNodes.length;n++){var s=this.reelParentNodes[n];if(s&&cc.isValid(s)){var r=this.node.width/2;cc.tween(s).parallel(cc.tween().to(e,{x:r},{easing:"sineIn"}),cc.tween().to(e,{scaleX:0},{easing:"sineIn"}),cc.tween().to(e,{opacity:0},{easing:"sineIn"})).start()}}this.btnAction&&this.btnAction.node&&cc.tween(this.btnAction.node).to(.5*e,{opacity:0}).start(),this.scheduleOnce((function(){i.isHidden=!0,i.node.active=!1;for(var e=0;e<i.reelParentNodes.length;e++){var n=i.reelParentNodes[e];n&&cc.isValid(n)&&(n.scaleX=1,n.opacity=255)}i.btnAction&&i.btnAction.node&&(i.btnAction.node.opacity=255),t&&t()}),e)},r.onDestroy=function(){this.btnAction&&this.btnAction.node&&this.btnAction.node.off("click",this.onActionButtonClick,this)},i}(cc.Component),g=i(d.prototype,"reelParentNodes",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),S=i(d.prototype,"btnAction",[a],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=i(d.prototype,"rewardSprites",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),v=i(d.prototype,"rollSpeed",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 800}}),m=i(d.prototype,"reelSpeeds",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[800,820,780]}}),b=i(d.prototype,"btnLabel",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=i(d.prototype,"iconHeight",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 100}}),y=i(d.prototype,"visibleIcons",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 3}}),f=d))||f));r._RF.pop()}}}));

System.register("chunks:///_virtual/SpriteAnimation.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(r){var t,e,i,a,n,o,s,c,u;return{setters:[function(r){t=r.applyDecoratedDescriptor,e=r.inheritsLoose,i=r.initializerDefineProperty,a=r.assertThisInitialized},function(r){n=r.cclegacy,o=r._decorator,s=r.SpriteFrame,c=r.Sprite,u=r.Component}],execute:function(){var l,m,p,f,h,y;n._RF.push({},"38976U0yvxLY7TOohNRyz3x","SpriteAnimation",void 0);var v=o.ccclass,g=o.property;r("SpriteAnimation",(l=v("SpriteAnimation"),m=g([s]),l((h=t((f=function(r){function t(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return t=r.call.apply(r,[this].concat(n))||this,i(t,"frames",h,a(t)),i(t,"frameRate",y,a(t)),t.currentFrame=0,t.accumulator=0,t}e(t,r);var n=t.prototype;return n.start=function(){this.frames&&0!==this.frames.length||console.error("Frames are not set!")},n.update=function(r){this.accumulator+=r;for(var t=1/this.frameRate;this.accumulator>=t;)this.accumulator-=t,this.currentFrame=(this.currentFrame+1)%this.frames.length;var e=this.node.getComponent(c);e&&(e.spriteFrame=this.frames[this.currentFrame])},t}(u)).prototype,"frames",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),y=t(f.prototype,"frameRate",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),p=f))||p));n._RF.pop()}}}));

System.register("chunks:///_virtual/startLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AudioManager.ts","./SimpleFingerAnimation.ts"],(function(t){var e,n,i,a,r,c,o,s,l,h,u;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,a=t.assertThisInitialized},function(t){r=t.cclegacy,c=t._decorator,o=t.Node,s=t.Button,l=t.Component},function(t){h=t.AudioManager},function(t){u=t.SimpleFingerAnimation}],execute:function(){var d,p,C,g,f,v,y,m,B,b,L,x;r._RF.push({},"ccfbdt1ZrFEOLkvliWcdTis","startLayer",void 0);var S=c.ccclass,N=c.property;t("startLayer",(d=S("startLayer"),p=N(o),C=N(o),g=N(o),f=N(o),d(((x=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return e=t.call.apply(t,[this].concat(r))||this,i(e,"nextButton",m,a(e)),i(e,"character1Btn",B,a(e)),i(e,"character2Btn",b,a(e)),i(e,"nextLayer",L,a(e)),e.selectedCharacter=0,e.fingerAnim=null,e}n(e,t);var r=e.prototype;return r.start=function(){this.initButtons(),this.hideNextLayer();var t=cc.find("Canvas");t&&t.getComponent("GameManager").showFinger(cc.Vec3(0,0,0),cc.Vec3(-115.76,-57.369,0))},r.initButtons=function(){var t=this.character1Btn.getComponent(s);t&&t.node.on(s.EventType.CLICK,this.onCharacter1Selected,this);var e=this.character2Btn.getComponent(s);e&&e.node.on(s.EventType.CLICK,this.onCharacter2Selected,this);var n=this.nextButton.getComponent(s);n&&(n.node.on(s.EventType.CLICK,this.onNextButtonClick,this),n.interactable=!1)},r.showFinger=function(t,e){var n=cc.find("Canvas/shou");n&&(this.fingerAnim=n.getComponent(u)),this.fingerAnim.showAtPosition(t,e)},r.onCharacter1Selected=function(){var t=cc.find("Canvas");t&&t.getComponent("GameManager").showFinger(cc.Vec3(0,0,0),cc.Vec3(16,-516.93,0));h.instance.playSound("voc_click",.8),this.selectedCharacter=1,this.updateButtonStates(),this.enableNextButton(),console.log("é€‰æ‹©äº†è§’è‰²1"),this.node.getChildByName("Node1").active=!0,this.node.getChildByName("Node2").active=!1},r.onCharacter2Selected=function(){h.instance.playSound("voc_click",.8),this.selectedCharacter=2,this.updateButtonStates(),this.enableNextButton(),console.log("é€‰æ‹©äº†è§’è‰²2"),this.node.getChildByName("Node1").active=!1,this.node.getChildByName("Node2").active=!0},r.updateButtonStates=function(){this.character1Btn.getComponent(s),this.character2Btn.getComponent(s)},r.enableNextButton=function(){var t=this.nextButton.getComponent(s);t&&(t.interactable=!0)},r.onNextButtonClick=function(){if(0!==this.selectedCharacter){var t=cc.find("Canvas");if(t){var n=t.getComponent("GameManager");n.hideFinger(),n.showFinger(cc.Vec3(0,0,0),cc.Vec3(16,-516.93,0))}h.instance.playSound("voc_click",.8),h.instance.stopMusic(),h.instance.playMusic("bgm1"),this.node.emit(e.EVENT_CHARACTER_SELECTED,this.selectedCharacter),this.node.active=!1,this.nextLayer&&(this.nextLayer.active=!0),console.log("è¿›å…¥ä¸‹ä¸€ä¸ªç•Œé¢ï¼Œå·²é€‰æ‹©è§’è‰²: "+this.selectedCharacter)}else console.warn("è¯·å…ˆé€‰æ‹©ä¸€ä¸ªè§’è‰²")},r.hideNextLayer=function(){this.nextLayer&&(this.nextLayer.active=!1)},r.getSelectedCharacter=function(){return this.selectedCharacter},r.resetSelection=function(){this.selectedCharacter=0;var t=this.nextButton.getComponent(s);t&&(t.interactable=!1),this.updateButtonStates()},r.showLayer=function(){this.node.active=!0,this.resetSelection()},r.update=function(t){},e}(l)).EVENT_CHARACTER_SELECTED="character-selected",m=e((y=x).prototype,"nextButton",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=e(y.prototype,"character1Btn",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=e(y.prototype,"character2Btn",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=e(y.prototype,"nextLayer",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=y))||v));r._RF.pop()}}}));

System.register("chunks:///_virtual/UnitSpawnedRouter.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var n,t,r,o;return{setters:[function(e){n=e.inheritsLoose},function(e){t=e.cclegacy,r=e._decorator,o=e.Component}],execute:function(){var c;t._RF.push({},"4036elyMVlGiY8ozDOerJgV","UnitSpawnedRouter",void 0);var u=r.ccclass;r.property,e("UnitSpawnedRouter",u("UnitSpawnedRouter")(c=function(e){function t(){for(var n,t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return(n=e.call.apply(e,[this].concat(r))||this).spawner=null,n}return n(t,e),t}(o))||c);t._RF.pop()}}}));

System.register("chunks:///_virtual/UnitSpawner.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UnitSpawnedRouter.ts"],(function(t){var i,e,n,o,a,r,l,s,u,p,h,c,f,d,w,m,b,y;return{setters:[function(t){i=t.applyDecoratedDescriptor,e=t.inheritsLoose,n=t.initializerDefineProperty,o=t.assertThisInitialized,a=t.createClass},function(t){r=t.cclegacy,l=t._decorator,s=t.Prefab,u=t.Node,p=t.Enum,h=t.KeyCode,c=t.NodePool,f=t.instantiate,d=t.input,w=t.Input,m=t.Vec3,b=t.Component},function(t){y=t.UnitSpawnedRouter}],execute:function(){var _,v,P,g,z,S,R,x,C,D,I,M,W,A,K,E,L,O,N,U,T,k,F,V,Y,j,q;r._RF.push({},"bdf06hQOr1KcZcoUh/kemf3","UnitSpawner",void 0);var B=l.ccclass,H=l.property;t("UnitSpawner",(_=B("UnitSpawner"),v=H({type:s,tooltip:"è¦åˆ·æ–°çš„å•ä½ï¼ˆæ€ªç‰©ï¼‰é¢„åˆ¶ä½“"}),P=H({type:u,tooltip:"ç”Ÿæˆåæ”¾å…¥çš„çˆ¶èŠ‚ç‚¹ï¼›ä¸ºç©ºåˆ™ä½¿ç”¨ Spawner è‡ªèº«"}),g=H({type:[u],tooltip:"å¯é€‰ï¼šå¤šä¸ªå‡ºç”Ÿç‚¹ã€‚å¦‚æœä¸å¡«ï¼Œåˆ™ä»¥ Spawner è‡ªèº«ä¸ºå‡ºç”Ÿç‚¹"}),z=H({tooltip:"æ˜¯å¦è‡ªåŠ¨æŒ‰é€Ÿç‡åˆ·æ€ª"}),S=H({tooltip:"æ¯ç§’ç”Ÿæˆå¤šå°‘ä¸ªï¼ˆå•ä½/ç§’ï¼‰ã€‚å¯ä¸ºå°æ•°ï¼Œä¾‹å¦‚ 0.5 = 2 ç§’ä¸€ä¸ª"}),R=H({tooltip:"è‡ªåŠ¨åˆ·æ€ªå‰çš„å»¶è¿Ÿï¼ˆç§’ï¼‰"}),x=H({tooltip:"åŒå±æœ€å¤§å­˜æ´»æ•°é‡ã€‚0 è¡¨ç¤ºä¸é™åˆ¶"}),C=H({tooltip:"åœ¨å‡ºç”Ÿç‚¹å‘¨å›´éšæœºåŠå¾„ï¼ˆç±³/åƒç´ ï¼Œæ ¹æ®ä½ çš„åæ ‡ç³»ï¼‰"}),D=H({tooltip:"å¤šä¸ªå‡ºç”Ÿç‚¹æ—¶æ˜¯å¦éšæœºé€‰æ‹©ï¼›å¦åˆ™é¡ºåºè½®è¯¢"}),I=H({type:p(h),tooltip:"æ‰‹åŠ¨åˆ·æ€ªçƒ­é”®"}),M=H({tooltip:"æ˜¯å¦å¯ç”¨å¯¹è±¡æ± ï¼ˆæ¨èï¼‰"}),W=H({tooltip:"å¯¹è±¡æ± é¢„çƒ­æ•°é‡ï¼ˆä»… usePooling=true ç”Ÿæ•ˆï¼‰"}),_((E=i((K=function(t){function i(){for(var i,e=arguments.length,a=new Array(e),r=0;r<e;r++)a[r]=arguments[r];return i=t.call.apply(t,[this].concat(a))||this,n(i,"unitPrefab",E,o(i)),n(i,"parent",L,o(i)),n(i,"spawnPoints",O,o(i)),n(i,"autoSpawn",N,o(i)),n(i,"spawnRate",U,o(i)),n(i,"initialDelay",T,o(i)),n(i,"maxAlive",k,o(i)),n(i,"randomRadius",F,o(i)),n(i,"randomizePoints",V,o(i)),n(i,"manualKey",Y,o(i)),n(i,"usePooling",j,o(i)),n(i,"poolWarmCount",q,o(i)),i._pool=null,i._accum=0,i._delayLeft=0,i._pointIndex=0,i._alive=new Set,i}e(i,t);var r=i.prototype;return r.onLoad=function(){if(this.parent||(this.parent=this.node),this._delayLeft=Math.max(0,this.initialDelay),this.usePooling&&(this._pool=new c,this.unitPrefab&&this.poolWarmCount>0))for(var t=0;t<this.poolWarmCount;t++){var i=f(this.unitPrefab);i.active=!1,this._pool.put(i)}},r.onEnable=function(){d.on(w.EventType.KEY_DOWN,this._onKeyDown,this)},r.onDisable=function(){d.off(w.EventType.KEY_DOWN,this._onKeyDown,this)},r.update=function(t){if(this.autoSpawn)if(this._delayLeft>0)this._delayLeft-=t;else{this._accum+=t;for(var i=this.interval;this._accum>=i&&(this._accum-=i,this.spawnOne(),!(this.maxAlive>0&&this._alive.size>=this.maxAlive)););}},r.startAuto=function(t){void 0===t&&(t=0),this.autoSpawn=!0,this._delayLeft=t},r.stopAuto=function(){this.autoSpawn=!1,this._accum=0},r.setRate=function(t){this.spawnRate=Math.max(0,t)},r.spawn=function(t){void 0===t&&(t=1);for(var i=0;i<t;i++)this.spawnOne()},r.release=function(t){t&&t.isValid&&(this._alive.delete(t),this._pool&&this.usePooling?(t.removeFromParent(),t.active=!1,this._pool.put(t)):t.destroy())},r.spawnOne=function(){if(!this.unitPrefab)return null;if(this.maxAlive>0&&this._alive.size>=this.maxAlive)return null;var t;t=this._pool&&this.usePooling&&this._pool.size()>0?this._pool.get():f(this.unitPrefab),(this.parent||this.node).addChild(t),t.active=!0;var i=this._calcSpawnWorldPos();return t.setWorldPosition(i),this._alive.add(t),(t.getComponent(y)||t.addComponent(y)).spawner=this,t},r._onKeyDown=function(t){t.keyCode===this.manualKey&&this.spawnOne()},r._calcSpawnWorldPos=function(){var t=new m;if(this.spawnPoints&&this.spawnPoints.length>0){var i=0;this.randomizePoints?i=Math.floor(Math.random()*this.spawnPoints.length):(i=this._pointIndex%this.spawnPoints.length,this._pointIndex++),this.spawnPoints[i].getWorldPosition(t)}else this.node.getWorldPosition(t);if(this.randomRadius>0){var e=this.randomRadius*Math.sqrt(Math.random()),n=Math.random()*Math.PI*2;t.x+=e*Math.cos(n),t.y+=e*Math.sin(n)}return t},a(i,[{key:"interval",get:function(){return this.spawnRate<=0?Number.POSITIVE_INFINITY:1/this.spawnRate}}]),i}(b)).prototype,"unitPrefab",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=i(K.prototype,"parent",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=i(K.prototype,"spawnPoints",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),N=i(K.prototype,"autoSpawn",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),U=i(K.prototype,"spawnRate",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),T=i(K.prototype,"initialDelay",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),k=i(K.prototype,"maxAlive",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),F=i(K.prototype,"randomRadius",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),V=i(K.prototype,"randomizePoints",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Y=i(K.prototype,"manualKey",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return h.SPACE}}),j=i(K.prototype,"usePooling",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),q=i(K.prototype,"poolWarmCount",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),A=K))||A));r._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});